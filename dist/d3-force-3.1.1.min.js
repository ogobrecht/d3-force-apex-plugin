function netGobrechtsD3Force(t,e,o,n){"use strict";var a={conf:{},confDefaults:{},data:{},dom:{},events:{},lib:{},main:{},status:{},tools:{},version:"3.1.1m"},r={};return a.main.init=function(){a.dom.containerId=t||"D3Force"+Math.floor(1e6*Math.random()),a.confUser=e||{},a.status.apexPluginId=o,a.status.apexPageItemsToSubmit=!(!n||""===n)&&n.replace(/\s/g,"").split(","),a.main.setupConfiguration(),a.main.setupDom(),a.main.setupFunctionReferences()},a.main.setupConfiguration=function(){a.conf.debug=a.status.apexPluginId&&1===apex.jQuery("#pdebug").length,a.status.debugPrefix="D3 Force in DOM container #"+a.dom.containerId+": ",a.status.customize=!1,a.status.customizeCurrentMenu="nodes",a.status.customizeCurrentTabPosition=null,a.status.forceTickCounter=0,a.status.forceStartTime=0,a.status.forceRunning=!1,a.status.graphStarted=!1,a.status.graphRendering=!1,a.status.graphReady=!1,a.status.graphOldPositions=null,a.status.sampleData=!1,a.status.wrapLabelsOnNextTick=!1,a.status.labelFontSize=null,a.status.resizeTriggered=!1,a.confDefaults.minNodeRadius={display:!0,relation:"node",type:"number",val:6,options:[12,11,10,9,8,7,6,5,4,3,2,1]},a.confDefaults.maxNodeRadius={display:!0,relation:"node",type:"number",val:18,options:[36,34,32,30,28,26,24,22,20,18,16,14,12]},a.confDefaults.colorScheme={display:!0,relation:"node",type:"text",val:"color20",options:["color20","color20b","color20c","color10","direct"]},a.confDefaults.dragMode={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.pinMode={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.nodeEventToStopPinMode={display:!0,relation:"node",type:"text",val:"contextmenu",options:["none","dblclick","contextmenu"]},a.confDefaults.onNodeContextmenuPreventDefault={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.nodeEventToOpenLink={display:!0,relation:"node",type:"text",val:"dblclick",options:["none","click","dblclick","contextmenu"]},a.confDefaults.nodeLinkTarget={display:!0,relation:"node",type:"text",val:"_blank",options:["none","_blank","nodeID","domContainerID"]},a.confDefaults.showLabels={display:!0,relation:"label",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.wrapLabels={display:!0,relation:"label",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.labelSplitCharacter={display:!0,relation:"label",type:"text",val:"none",options:["none","^","`","Â°","\\","|","/","#",":","::"]},a.confDefaults.wrappedLabelWidth={display:!0,relation:"label",type:"number",val:80,options:[200,190,180,170,160,150,140,130,120,110,100,90,80,70,60,50,40]},a.confDefaults.wrappedLabelLineHeight={display:!0,relation:"label",type:"number",val:1.2,options:[1.5,1.4,1.3,1.2,1.1,1]},a.confDefaults.labelsCircular={display:!0,relation:"label",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.labelDistance={display:!0,relation:"label",type:"number",val:12,options:[30,28,26,24,22,20,18,16,14,12,10,8,6,4,2]},a.confDefaults.preventLabelOverlappingOnForceEnd={display:!0,relation:"label",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.labelPlacementIterations={display:!0,relation:"label",type:"number",val:250,options:[2e3,1e3,500,250,125]},a.confDefaults.showTooltips={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.tooltipPosition={display:!0,relation:"node",type:"text",val:"svgTopRight",options:["node","svgTopLeft","svgTopRight"]},a.confDefaults.alignFixedNodesToGrid={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.gridSize={display:!0,relation:"node",type:"number",val:50,options:[150,140,130,120,110,100,90,80,70,60,50,40,30,20,10]},a.confDefaults.linkDistance={display:!0,relation:"link",type:"number",val:80,options:[120,110,100,90,80,70,60,50,40,30,20]},a.confDefaults.showLinkDirection={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.showSelfLinks={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.selfLinkDistance={display:!0,relation:"link",type:"number",val:20,options:[30,28,26,24,22,20,18,16,14,12,10,8]},a.confDefaults.useDomParentWidth={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.width={display:!0,relation:"graph",type:"number",val:600,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},a.confDefaults.height={display:!0,relation:"graph",type:"number",val:400,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},a.confDefaults.setDomParentPaddingToZero={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.showBorder={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.showLegend={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.showLoadingIndicatorOnAjaxCall={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.lassoMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.zoomMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.minZoomFactor={display:!0,relation:"graph",type:"number",val:.2,options:[1,.9,.8,.7,.6,.5,.4,.3,.2,.1]},a.confDefaults.maxZoomFactor={display:!0,relation:"graph",type:"number",val:5,options:[10,9,8,7,6,5,4,3,2,1]},a.confDefaults.transform={display:!1,relation:"graph",type:"object",val:{translate:[0,0],scale:1}},a.confDefaults.zoomToFitOnForceEnd={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.zoomToFitOnResize={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.keepAspectRatioOnResize={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},a.confDefaults.onResizeFunctionTimeout={display:!0,relation:"graph",type:"number",val:300,options:[1e3,900,800,700,600,500,400,300,200,100,0]},a.confDefaults.autoRefresh={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},a.confDefaults.refreshInterval={display:!0,relation:"graph",type:"number",val:5e3,options:[6e4,3e4,15e3,1e4,5e3,2500]},a.confDefaults.forceTimeLimit={display:!0,relation:"graph",type:"number",val:1/0,options:[1/0,6400,3200,1600,800,400,200,100]},a.confDefaults.chargeDistance={display:!1,relation:"graph",type:"number",val:1/0,options:[1/0,25600,12800,6400,3200,1600,800,400,200,100],internal:!0},a.confDefaults.charge={display:!0,relation:"graph",type:"number",val:-350,options:[-1e3,-950,-900,-850,-800,-750,-700,-650,-600,-550,-500,-450,-400,-350,-300,-250,-200,-150,-100,-50,0],internal:!0},a.confDefaults.gravity={display:!0,relation:"graph",type:"number",val:.1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},a.confDefaults.linkStrength={display:!0,relation:"graph",type:"number",val:1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},a.confDefaults.friction={display:!0,relation:"graph",type:"number",val:.9,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},a.confDefaults.theta={display:!0,relation:"graph",type:"number",val:.8,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},a.confDefaults.lineCornerSmooth={display:!0,relation:"link",type:"number",val:10,options:[0,5,10,15]},a.conf.debug=void 0!==a.confUser.debug&&a.tools.parseBool(a.confUser.debug),a.conf.minNodeRadius=a.confUser.minNodeRadius||a.confDefaults.minNodeRadius.val,a.conf.maxNodeRadius=a.confUser.maxNodeRadius||a.confDefaults.maxNodeRadius.val,a.conf.colorScheme=a.confUser.colorScheme||a.confDefaults.colorScheme.val,a.conf.dragMode=void 0!==a.confUser.dragMode?a.tools.parseBool(a.confUser.dragMode):a.confDefaults.dragMode.val,a.conf.pinMode=void 0!==a.confUser.pinMode?a.tools.parseBool(a.confUser.pinMode):a.confDefaults.pinMode.val,a.conf.nodeEventToStopPinMode=a.confUser.nodeEventToStopPinMode||a.confDefaults.nodeEventToStopPinMode.val,a.conf.onNodeContextmenuPreventDefault=void 0!==a.confUser.onNodeContextmenuPreventDefault?a.tools.parseBool(a.confUser.onNodeContextmenuPreventDefault):a.confDefaults.onNodeContextmenuPreventDefault.val,a.conf.nodeEventToOpenLink=a.confUser.nodeEventToOpenLink||a.confDefaults.nodeEventToOpenLink.val,a.conf.nodeLinkTarget=a.confUser.nodeLinkTarget||a.confDefaults.nodeLinkTarget.val,a.conf.showLabels=void 0!==a.confUser.showLabels?a.tools.parseBool(a.confUser.showLabels):a.confDefaults.showLabels.val,a.conf.wrapLabels=void 0!==a.confUser.wrapLabels?a.tools.parseBool(a.confUser.wrapLabels):a.confDefaults.wrapLabels.val,a.conf.labelSplitCharacter=a.confUser.labelSplitCharacter||a.confDefaults.labelSplitCharacter.val,a.conf.wrappedLabelWidth=a.confUser.wrappedLabelWidth||a.confDefaults.wrappedLabelWidth.val,a.conf.wrappedLabelLineHeight=a.confUser.wrappedLabelLineHeight||a.confDefaults.wrappedLabelLineHeight.val,a.conf.labelsCircular=void 0!==a.confUser.labelsCircular?a.tools.parseBool(a.confUser.labelsCircular):a.confDefaults.labelsCircular.val,a.conf.labelDistance=a.confUser.labelDistance||a.confDefaults.labelDistance.val,a.conf.preventLabelOverlappingOnForceEnd=void 0!==a.confUser.preventLabelOverlappingOnForceEnd?a.tools.parseBool(a.confUser.preventLabelOverlappingOnForceEnd):a.confDefaults.preventLabelOverlappingOnForceEnd.val,a.conf.labelPlacementIterations=a.confUser.labelPlacementIterations||a.confDefaults.labelPlacementIterations.val,a.conf.showTooltips=void 0!==a.confUser.showTooltips?a.tools.parseBool(a.confUser.showTooltips):a.confDefaults.showTooltips.val,a.conf.tooltipPosition=a.confUser.tooltipPosition||a.confDefaults.tooltipPosition.val,a.conf.alignFixedNodesToGrid=void 0!==a.confUser.alignFixedNodesToGrid?a.tools.parseBool(a.confUser.alignFixedNodesToGrid):a.confDefaults.alignFixedNodesToGrid.val,a.conf.gridSize=a.confUser.gridSize&&a.confUser.gridSize>0?a.confUser.gridSize:a.confDefaults.gridSize.val,a.conf.linkDistance=a.confUser.linkDistance||a.confDefaults.linkDistance.val,a.conf.showLinkDirection=void 0!==a.confUser.showLinkDirection?a.tools.parseBool(a.confUser.showLinkDirection):a.confDefaults.showLinkDirection.val,a.conf.showSelfLinks=void 0!==a.confUser.showSelfLinks?a.tools.parseBool(a.confUser.showSelfLinks):a.confDefaults.showSelfLinks.val,a.conf.selfLinkDistance=a.confUser.selfLinkDistance||a.confDefaults.selfLinkDistance.val,a.conf.useDomParentWidth=void 0!==a.confUser.useDomParentWidth?a.tools.parseBool(a.confUser.useDomParentWidth):a.confDefaults.useDomParentWidth.val,a.conf.width=a.confUser.width||a.confDefaults.width.val,a.conf.height=a.confUser.height||a.confDefaults.height.val,a.conf.setDomParentPaddingToZero=void 0!==a.confUser.setDomParentPaddingToZero?a.tools.parseBool(a.confUser.setDomParentPaddingToZero):a.confDefaults.setDomParentPaddingToZero.val,a.conf.showBorder=void 0!==a.confUser.showBorder?a.tools.parseBool(a.confUser.showBorder):a.confDefaults.showBorder.val,a.conf.showLegend=void 0!==a.confUser.showLegend?a.tools.parseBool(a.confUser.showLegend):a.confDefaults.showLegend.val,a.conf.showLoadingIndicatorOnAjaxCall=void 0!==a.confUser.showLoadingIndicatorOnAjaxCall?a.tools.parseBool(a.confUser.showLoadingIndicatorOnAjaxCall):a.confDefaults.showLoadingIndicatorOnAjaxCall.val,a.conf.lassoMode=void 0!==a.confUser.lassoMode?a.tools.parseBool(a.confUser.lassoMode):a.confDefaults.lassoMode.val,a.conf.zoomMode=void 0!==a.confUser.zoomMode?a.tools.parseBool(a.confUser.zoomMode):a.confDefaults.zoomMode.val,a.conf.minZoomFactor=a.confUser.minZoomFactor||a.confDefaults.minZoomFactor.val,a.conf.maxZoomFactor=a.confUser.maxZoomFactor||a.confDefaults.maxZoomFactor.val,a.conf.transform=a.confUser.transform||a.confDefaults.transform.val,a.conf.zoomToFitOnForceEnd=void 0!==a.confUser.zoomToFitOnForceEnd?a.tools.parseBool(a.confUser.zoomToFitOnForceEnd):a.confDefaults.zoomToFitOnForceEnd.val,a.conf.zoomToFitOnResize=void 0!==a.confUser.zoomToFitOnResize?a.tools.parseBool(a.confUser.zoomToFitOnResize):a.confDefaults.zoomToFitOnResize.val,a.conf.keepAspectRatioOnResize=void 0!==a.confUser.keepAspectRatioOnResize?a.tools.parseBool(a.confUser.keepAspectRatioOnResize):a.confDefaults.keepAspectRatioOnResize.val,a.conf.onResizeFunctionTimeout=a.confUser.onResizeFunctionTimeout||a.confDefaults.onResizeFunctionTimeout.val,a.conf.autoRefresh=void 0!==a.confUser.autoRefresh?a.tools.parseBool(a.confUser.autoRefresh):a.confDefaults.autoRefresh.val,a.conf.refreshInterval=a.confUser.refreshInterval||a.confDefaults.refreshInterval.val,a.conf.forceTimeLimit=a.confUser.forceTimeLimit||a.confDefaults.forceTimeLimit.val,a.conf.chargeDistance=a.confUser.chargeDistance||a.confDefaults.forceTimeLimit.val,a.conf.charge=a.confUser.charge||a.confDefaults.charge.val,a.conf.gravity=a.confUser.gravity||a.confDefaults.gravity.val,a.conf.linkStrength=a.confUser.linkStrength||a.confDefaults.linkStrength.val,a.conf.friction=a.confUser.friction||a.confDefaults.friction.val,a.conf.theta=a.confUser.theta||a.confDefaults.theta.val,a.conf.onNodeMouseenterFunction=a.confUser.onNodeMouseenterFunction||null,a.conf.onNodeMouseleaveFunction=a.confUser.onNodeMouseleaveFunction||null,a.conf.onNodeClickFunction=a.confUser.onNodeClickFunction||null,a.conf.onNodeDblclickFunction=a.confUser.onNodeDblclickFunction||null,a.conf.onNodeContextmenuFunction=a.confUser.onNodeContextmenuFunction||null,a.conf.onLinkClickFunction=a.confUser.onLinkClickFunction||null,a.conf.onLassoStartFunction=a.confUser.onLassoStartFunction||null,a.conf.onLassoEndFunction=a.confUser.onLassoEndFunction||null,a.conf.onRenderEndFunction=a.confUser.onRenderEndFunction||null,a.conf.onForceStartFunction=a.confUser.onForceStartFunction||null,a.conf.onForceEndFunction=a.confUser.onForceEndFunction||null,a.conf.onResizeFunction=a.confUser.onResizeFunction||null,a.conf.lineCornerSmooth=a.confUser.lineCornerSmooth||a.confDefaults.lineCornerSmooth.val,console.log(a.conf),a.data.sampleData='<data><nodes ID="7839" LABEL="KING is THE KING, you know?" LABELCIRCULAR="true" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="5000" LINK="http://apex.oracle.com/" INFOSTRING="This visualization is based on the well known emp table." /><nodes ID="7698" LABEL="BLAKE" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="2850" /><nodes ID="7782" LABEL="CLARK" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="2450" /><nodes ID="7566" LABEL="JONES" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="2975" /><nodes ID="7788" LABEL="SCOTT with a very long label" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7902" LABEL="FORD" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7369" LABEL="SMITH" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="800" /><nodes ID="7499" LABEL="ALLEN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1600" /><nodes ID="7521" LABEL="WARD" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7654" LABEL="MARTIN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7844" LABEL="TURNER" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1500" /><nodes ID="7876" LABEL="ADAMS" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="1100" /><nodes ID="7900" LABEL="JAMES" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="950" /><nodes ID="7934" LABEL="MILLER" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="1300" /><nodes ID="8888" LABEL="Who am I?" COLORVALUE="green" COLORLABEL="unspecified" SIZEVALUE="2000" LINK="https://ogobrecht.github.io/d3-force-apex-plugin/module-API.html#.nodeLinkTarget" INFOSTRING="This is a good question. Think about it." /><nodes ID="9999" LABEL="Where I am?" COLORVALUE="#f00" COLORLABEL="unspecified" SIZEVALUE="1000" LINK="https://ogobrecht.github.io/d3-force-apex-plugin/module-API.html#.nodeLinkTarget" INFOSTRING="This is a good question. What do you think?" /><links FROMID="7839" TOID="7839" STYLE="dotted" COLOR="blue" INFOSTRING="This is a self link (same source and target node) rendered along a path with the STYLE attribute set to dotted and COLOR attribute set to blue." /><links FROMID="7698" TOID="7839" STYLE="dashed" /><links FROMID="7782" TOID="7839" STYLE="dashed" COLOR="red" INFOSTRING="This is a link with the STYLE attribute set to dashed and COLOR attribute set to red." /><links FROMID="7566" TOID="7839" STYLE="dashed" /><links FROMID="7788" TOID="7566" STYLE="solid" /><links FROMID="7902" TOID="7566" STYLE="solid" /><links FROMID="7369" TOID="7902" STYLE="solid" /><links FROMID="7499" TOID="7698" STYLE="solid" LABEL="Allen>Blake" INFOSTRING="This link has the LABEL and INFOSTRING attributes set." /><links FROMID="7521" TOID="7698" STYLE="solid" /><links FROMID="7654" TOID="7698" STYLE="solid" /><links FROMID="7844" TOID="7698" STYLE="solid" /><links FROMID="7876" TOID="7788" STYLE="solid" /><links FROMID="7900" TOID="7698" STYLE="solid" /><links FROMID="7934" TOID="7782" STYLE="solid" /></data>',a.status.userAgent=navigator.userAgent,a.status.userAgentIe9To11=!1,(-1!==navigator.appVersion.indexOf("MSIE 9")||-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==a.status.userAgent.indexOf("Trident")&&-1!==a.status.userAgent.indexOf("rv:11"))&&(a.status.userAgentIe9To11=!0,a.tools.logError("Houston, we have a problem - user agent is IE 9, 10 or 11 - we have to provide a fix for markers: http://stackoverflow.com/questions/15588478/internet-explorer-10-not-showing-svg-path-d3-js-graph"))},a.main.setupDom=function(){var t,e;a.dom.body=d3.select("body"),null===document.querySelector("#"+a.dom.containerId)?a.dom.container=a.dom.body.append("div").attr("id",a.dom.containerId):(a.dom.container=d3.select("#"+a.dom.containerId),d3.selectAll("#"+a.dom.containerId+"_tooltip, #"+a.dom.containerId+"_customizing").remove()),null===document.querySelector("#"+a.dom.containerId+" svg")?a.dom.svg=a.dom.container.append("svg"):(a.dom.svg=d3.select("#"+a.dom.containerId+" svg"),d3.selectAll("#"+a.dom.containerId+" svg *").remove()),a.dom.svgParent=d3.select(a.dom.svg.node().parentNode),a.conf.setDomParentPaddingToZero&&a.dom.svgParent.style("padding","0"),t=a.tools.getGraphWidth(),e=a.tools.getGraphHeight(),a.dom.svg.attr("class","net_gobrechts_d3_force").classed("border",a.conf.showBorder).attr("width",t).attr("height",e),a.conf.useDomParentWidth&&a.dom.svg.attr("width",a.tools.getSvgParentInnerWidth()),a.dom.defs=a.dom.svg.append("defs"),a.dom.graphOverlay=a.dom.svg.append("g").attr("class","graphOverlay"),a.dom.graphOverlaySizeHelper=a.dom.graphOverlay.append("rect").attr("class","graphOverlaySizeHelper"),a.dom.graph=a.dom.graphOverlay.append("g").attr("class","graph"),a.dom.legend=a.dom.svg.append("g").attr("class","legend"),a.dom.loading=a.dom.svg.append("svg:g").attr("class","loading").style("display","none"),a.dom.loadingRect=a.dom.loading.append("svg:rect").attr("width",t).attr("height",e),a.dom.loadingText=a.dom.loading.append("svg:text").attr("x",t/2).attr("y",e/2).text("Loading..."),a.dom.defs.append("svg:marker").attr("id",a.dom.containerId+"_highlighted").attr("class","highlighted").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),a.dom.defs.append("svg:marker").attr("id",a.dom.containerId+"_normal").attr("class","normal").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),null===document.querySelector("#"+a.dom.containerId+"_tooltip")?a.dom.tooltip=a.dom.body.append("div").attr("id",a.dom.containerId+"_tooltip").attr("class","net_gobrechts_d3_force_tooltip").style("top","0px").style("left","0px"):a.dom.tooltip=d3.select("#"+a.dom.containerId+"_tooltip")},a.main.setupFunctionReferences=function(){a.main.force=d3.layout.force().on("start",function(){a.tools.log("Force started."),a.status.customize&&a.dom.customizePositions&&a.dom.customizePositions.text("Force started - wait for end event to show positions..."),a.status.forceTickCounter=0,a.status.forceStartTime=(new Date).getTime(),a.status.forceRunning=!0,a.tools.log("Event forcestart triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_forcestart"),"function"==typeof a.conf.onForceStartFunction&&a.conf.onForceStartFunction.call(a.dom.svg)}).on("tick",function(){a.status.forceTickCounter+=1,a.status.userAgentIe9To11&&a.conf.showLinkDirection&&(a.main.links.each(function(){this.parentNode.insertBefore(this,this)}),a.main.selfLinks.each(function(){this.parentNode.insertBefore(this,this)})),a.main.selfLinks.attr("transform",function(t){return"translate("+t.source.x+","+t.source.y+")"}),a.main.links.attr("d",function(t){return a.tools.adjustSquaredLinesPath(t)}),a.conf.showLabels&&(a.main.labels.attr("x",function(t){return t.x}).attr("y",function(t){return t.y-t.radius-a.conf.labelDistance}),a.status.wrapLabelsOnNextTick&&(a.main.labels.call(a.tools.wrapLabels,a.conf.wrappedLabelWidth),a.status.wrapLabelsOnNextTick=!1),a.conf.wrapLabels&&a.main.labels.each(function(){var t=d3.select(this),e=t.attr("y")-(t.attr("lines")-1)*a.status.labelFontSize*a.conf.wrappedLabelLineHeight;t.attr("y",e).selectAll("tspan").attr("x",t.attr("x")).attr("y",e)}),a.main.labelPaths.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),a.main.linkLabelPaths.attr("d",function(t){return"M "+t.source.x+" "+t.source.y+" L "+t.target.x+" "+t.target.y}),a.main.linkLabels.attr("transform",function(t,e){if(t.target.x<t.source.x){var o=this.getBBox();return"rotate(180 "+(o.x+o.width/2)+" "+(o.y+o.height/2)+")"}return"rotate(0)"})),a.main.nodes.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),(new Date).getTime()-a.status.forceStartTime>a.conf.forceTimeLimit&&a.main.force.stop()}).on("end",function(){a.conf.showLabels&&a.conf.preventLabelOverlappingOnForceEnd&&(a.data.simulatedAnnealingLabels=[],a.data.simulatedAnnealingAnchors=[],a.main.labels.each(function(t,e){var o=d3.select(this);a.data.simulatedAnnealingLabels[e]={width:this.getBBox().width,height:this.getBBox().height,x:t.x,y:o.attr("y")-(o.attr("lines")-1)*a.status.labelFontSize*a.conf.wrappedLabelLineHeight}}),a.main.nodes.filter(function(t){return!t.LABELCIRCULAR&&!a.conf.labelsCircular}).each(function(t,e){a.data.simulatedAnnealingAnchors[e]={x:t.x,y:t.y-t.radius-a.conf.labelDistance,r:.5}}),a.lib.labelerPlugin().label(a.data.simulatedAnnealingLabels).anchor(a.data.simulatedAnnealingAnchors).width(a.tools.getGraphWidth()).height(a.tools.getGraphHeight()).start(a.conf.labelPlacementIterations),a.main.labels.each(function(t,e){var o=d3.select(this),n=a.data.simulatedAnnealingLabels[e].x,r=a.data.simulatedAnnealingLabels[e].y;a.conf.wrapLabels?(r-=(o.attr("lines")-1)*a.status.labelFontSize*a.conf.wrappedLabelLineHeight,o.transition().duration(800).attr("x",n).attr("y",r).selectAll("tspan").attr("x",n).attr("y",r)):o.transition().duration(800).attr("x",n).attr("y",r)})),a.status.forceRunning=!1;var t=(new Date).getTime()-a.status.forceStartTime,e=(t/1e3).toFixed(1),o=Math.round(a.status.forceTickCounter/(t/1e3)),n=Math.round(t/a.status.forceTickCounter);a.status.customize&&a.dom.customizePositions&&a.dom.customizePositions.text(JSON.stringify(r.positions())),a.tools.log("Force ended."),a.tools.log(e+" seconds, "+a.status.forceTickCounter+" ticks to cool down ("+o+" ticks/s, "+n+" ms/tick)."),a.tools.log("Event forceend triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_forceend"),a.conf.zoomToFitOnForceEnd?r.zoomToFit():a.conf.zoomMode||r.center(),"function"==typeof a.conf.onForceEndFunction&&a.conf.onForceEndFunction.call(a.dom.svg)}),a.main.drag=a.main.force.drag(),a.main.lasso=a.lib.lassoPlugin().closePathDistance(100).closePathSelect(!0).hoverSelect(!0).area(a.dom.graphOverlay).pathContainer(a.dom.svg),a.main.zoom=d3.behavior.zoom(),a.main.zoomed=function(){a.conf.transform={translate:a.main.zoom.translate(),scale:a.main.zoom.scale()},a.dom.graph.attr("transform","translate("+a.main.zoom.translate()+")scale("+a.main.zoom.scale()+")"),a.tools.writeConfObjectIntoWizard()},a.main.interpolateZoom=function(t,e,o){if(a.status.graphStarted)return e<a.conf.minZoomFactor?e=a.conf.minZoomFactor:e>a.conf.maxZoomFactor&&(e=a.conf.maxZoomFactor),d3.transition().duration(o).tween("zoom",function(){var o=d3.interpolate(a.main.zoom.translate(),t),n=d3.interpolate(a.main.zoom.scale(),e);return function(t){a.main.zoom.scale(n(t)).translate(o(t)),a.main.zoomed()}})}},a.tools.parseBool=function(t){switch(String(t).trim().toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"":default:return!1}},a.tools.parseXml=function(t){var e=null;if(t)if(window.DOMParser)try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=null,a.tools.logError("DOMParser - unable to parse XML: "+t.message)}else if(window.ActiveXObject)try{(e=new ActiveXObject("Microsoft.XMLDOM")).async=!1,e.loadXML(t)||a.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+e.parseError.reason+e.parseError.srcText)}catch(t){e=null,a.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+t.message)}return e},a.tools.xmlToJson=function(t){var e,o,n,a,r,s=null,i=function(t){if(e={},t.attributes.length>0)for(var o=0;o<t.attributes.length;o++)r=t.attributes.item(o),e[r.nodeName]=r.nodeValue;if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++)(n=t.childNodes.item(a)).hasChildNodes()?e[n.nodeName]=n.childNodes.item(0).nodeValue:e[n.nodeName]="";return e};if(t&&((s={}).data={},s.data.nodes=[],s.data.links=[],t.childNodes.item(0).hasChildNodes()))for(var l=0;l<t.childNodes.item(0).childNodes.length;l++)e=null,"nodes"===(a=(o=t.childNodes.item(0).childNodes.item(l)).nodeName)||"node"===a?s.data.nodes.push(i(o)):"links"!==a&&"link"!==a||s.data.links.push(i(o));return s},a.tools.getSvgParentInnerWidth=function(){var t=parseInt(a.dom.svgParent.style("width")),e=parseInt(a.dom.svg.style("border-width"));return t=(isNaN(t)?a.conf.width:t)-parseInt(a.dom.svgParent.style("padding-left"))-parseInt(a.dom.svgParent.style("padding-right"))-2*(isNaN(e)?1:e)},a.tools.getGraphWidth=function(){return a.conf.useDomParentWidth?a.tools.getSvgParentInnerWidth():a.conf.width},a.tools.getGraphHeight=function(){return a.conf.useDomParentWidth&&a.conf.keepAspectRatioOnResize?1*a.tools.getSvgParentInnerWidth()/(a.status.aspectRatio?a.status.aspectRatio:1.5):a.conf.height},a.tools.executeResize=function(){var t=a.tools.getGraphWidth(),e=a.tools.getGraphHeight();a.dom.svg.attr("width",t),a.dom.svg.attr("height",e),a.dom.graphOverlaySizeHelper.attr("width",t),a.dom.graphOverlaySizeHelper.attr("height",e),a.dom.loadingRect.attr("width",t),a.dom.loadingRect.attr("height",e),a.dom.loadingText.attr("x",t/2),a.dom.loadingText.attr("y",e/2),a.main.zoom.size([t,e]),a.conf.zoomToFitOnResize?r.zoomToFit(0):a.conf.zoomMode||r.center(0),a.conf.showLegend&&a.tools.moveLegend(),a.tools.triggerResizeEvent()},a.tools.triggerResizeEvent=function(){a.status.graphStarted&&!a.status.resizeTriggered&&(a.status.resizeTriggered=!0,setTimeout(function(){a.tools.executeResizeEvent()},a.conf.onResizeFunctionTimeout))},a.tools.executeResizeEvent=function(){a.tools.log("Event resize triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_resize"),"function"==typeof a.conf.onResizeFunction&&a.conf.onResizeFunction.call(a.dom.svg),a.status.resizeTriggered=!1},a.tools.ResizeObserver=new ResizeObserver(function(t,e){t.forEach(function(t){a.conf.useDomParentWidth&&a.tools.executeResize()})}),a.tools.log=function(t,e){a.conf.debug&&(e?console.log(t):console.log(a.status.debugPrefix+t)),a.status.customize&&a.dom.customizeLog&&a.dom.customizeLog.text(t+"\n"+a.dom.customizeLog.text())},a.tools.logError=function(t){console.log(a.status.debugPrefix+"ERROR: "+t),a.status.customize&&a.dom.customizeLog&&a.dom.customizeLog.text("ERROR: "+t+"\n"+a.dom.customizeLog.text())},a.tools.triggerApexEvent=function(t,e,o){a.status.apexPluginId&&apex.event.trigger(t,e,o)},a.tools.setRadiusFunction=function(){a.tools.radius=d3.scale.sqrt().range([a.conf.minNodeRadius,a.conf.maxNodeRadius]).domain(d3.extent(a.data.nodes,function(t){return parseFloat(t.SIZEVALUE)}))},a.tools.setColorFunction=function(){"color20"===a.conf.colorScheme?a.tools.color=d3.scale.category20():"color20b"===a.conf.colorScheme?a.tools.color=d3.scale.category20b():"color20c"===a.conf.colorScheme?a.tools.color=d3.scale.category20c():"color10"===a.conf.colorScheme?a.tools.color=d3.scale.category10():"direct"===a.conf.colorScheme?a.tools.color=function(t){return t}:(a.conf.colorScheme="color20",a.tools.color=d3.scale.category20())},a.tools.neighboring=function(t,e){return a.data.neighbors.indexOf(t.ID+":"+e.ID)>-1||a.data.neighbors.indexOf(e.ID+":"+t.ID)>-1},a.tools.getNearestGridPosition=function(t,e){var o,n;return a.conf.zoomMode?n=(o=t%a.conf.gridSize)>a.conf.gridSize/2?t-o+a.conf.gridSize:t-o:t>=e?(n=e-(o=e%a.conf.gridSize))===e&&(n-=a.conf.gridSize):t<=a.conf.gridSize/2?n=a.conf.gridSize:(n=(o=t%a.conf.gridSize)>a.conf.gridSize/2?t-o+a.conf.gridSize:t-o)>=e&&(n-=a.conf.gridSize),n},a.tools.adjustSourceX=function(t){return t.source.x+Math.cos(a.tools.calcAngle(t))*t.source.radius},a.tools.adjustSourceY=function(t){return t.source.y+Math.sin(a.tools.calcAngle(t))*t.source.radius},a.tools.adjustTargetX=function(t){return t.target.x-Math.cos(a.tools.calcAngle(t))*t.target.radius},a.tools.adjustTargetY=function(t){return t.target.y-Math.sin(a.tools.calcAngle(t))*t.target.radius},a.tools.calcAngle=function(t){return Math.atan2(t.target.y-t.source.y,t.target.x-t.source.x)},a.tools.adjustSquaredLinesPath=function(t){var e="";return t.source.x!=t.target.x&&t.source.y!=t.target.y||(t.source.x==t.target.x&&t.source.y<t.target.y&&(e="M"+t.source.x+","+t.source.y+" L"+t.target.x+","+(t.target.y-t.target.radius)),t.source.x==t.target.x&&t.source.y>t.target.y&&(e="M"+t.source.x+","+t.source.y+" L"+t.target.x+","+(t.target.y+t.target.radius)),t.source.y==t.target.y&&t.source.x<t.target.x&&(e="M"+t.source.x+","+t.source.y+" L"+(t.target.x-t.target.radius)+","+t.target.y),t.source.y==t.target.y&&t.source.x>t.target.x&&(e="M"+t.source.x+","+t.source.y+" L"+(t.target.x+t.target.radius)+","+t.target.y)),"2"==t.LINE_TYPES?(t.source.x<t.target.x&&t.source.y>t.target.y&&(e="M"+t.source.x+" "+t.source.y,e+=" L"+(t.target.x-a.conf.lineCornerSmooth)+","+t.source.y,e+=" Q"+t.target.x+","+t.source.y+","+t.target.x+","+(t.source.y-a.conf.lineCornerSmooth),e+=" L"+t.target.x+","+(t.target.y+t.target.radius)),t.source.x<t.target.x&&t.source.y<t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+(t.target.x-a.conf.lineCornerSmooth)+","+t.source.y,e+=" Q"+t.target.x+","+t.source.y+","+t.target.x+","+(t.source.y+a.conf.lineCornerSmooth),e+=" L"+t.target.x+","+(t.target.y-t.target.radius)),t.source.x>t.target.x&&t.source.y>t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+(t.target.x+a.conf.lineCornerSmooth)+","+t.source.y,e+=" Q"+t.target.x+","+t.source.y+","+t.target.x+","+(t.source.y-a.conf.lineCornerSmooth),e+=" L"+t.target.x+","+(t.target.y+t.target.radius)),t.source.x>t.target.x&&t.source.y<t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+(t.target.x+a.conf.lineCornerSmooth)+","+t.source.y,e+=" Q"+t.target.x+","+t.source.y+","+t.target.x+","+(t.source.y+a.conf.lineCornerSmooth),e+=" L"+t.target.x+","+(t.target.y-t.target.radius))):(t.source.x<t.target.x&&t.source.y>t.target.y&&(e="M"+t.source.x+" "+t.source.y,e+=" L"+t.source.x+","+(t.target.y+a.conf.lineCornerSmooth),e+=" Q"+t.source.x+","+t.target.y+","+(t.source.x+a.conf.lineCornerSmooth)+","+t.target.y,e+=" L"+(t.target.x-t.target.radius)+","+t.target.y),t.source.x<t.target.x&&t.source.y<t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+t.source.x+","+(t.target.y-a.conf.lineCornerSmooth),e+=" Q"+t.source.x+","+t.target.y+","+(t.source.x+a.conf.lineCornerSmooth)+","+t.target.y,e+=" L"+(t.target.x-t.target.radius)+","+t.target.y),t.source.x>t.target.x&&t.source.y>t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+t.source.x+","+(t.target.y+a.conf.lineCornerSmooth),e+=" Q"+t.source.x+","+t.target.y+","+(t.source.x-a.conf.lineCornerSmooth)+","+t.target.y,e+=" L"+(t.target.x+t.target.radius)+","+t.target.y),t.source.x>t.target.x&&t.source.y<t.target.y&&(e="M"+t.source.x+","+t.source.y,e+=" L"+t.source.x+","+(t.target.y-a.conf.lineCornerSmooth),e+=" Q"+t.source.x+","+t.target.y+","+(t.source.x-a.conf.lineCornerSmooth)+","+t.target.y,e+=" L"+(t.target.x+t.target.radius)+","+t.target.y)),e},a.tools.getSelfLinkPath=function(t){var e=t.source.radius,o=t.source.radius+a.conf.selfLinkDistance,n={source:{x:0,y:0,radius:e},target:{x:0-o/2,y:0+o,radius:e}},r={source:{x:0+o/2,y:0+o,radius:e},target:{x:0,y:0,radius:e}},s="M"+a.tools.adjustSourceX(n)+","+a.tools.adjustSourceY(n);return s+=" L"+(0-o/2)+","+(0+o),s+=" A"+o+","+o+" 0 0,0 "+(0+o/2)+","+(0+o),s+=" L"+a.tools.adjustTargetX(r)+","+a.tools.adjustTargetY(r)},a.tools.getLabelPath=function(t){var e=t.radius+a.conf.labelDistance,o="M"+(0-e)+",0";return o+=" a"+e+","+e+" 0 0,1 "+2*e+",0",o+=" a"+e+","+e+" 0 0,1 -"+2*e+",0"},a.tools.getPatternId=function(t){return a.dom.containerId+"_pattern_"+t.ID},a.tools.getLinkId=function(t){return t.FROMID+"_"+t.TOID},a.tools.getPathId=function(t){return a.dom.containerId+"_path_"+a.tools.getLinkId(t)},a.tools.openLink=function(t){"none"===a.conf.nodeLinkTarget?window.location.assign(t.LINK):"nodeID"===a.conf.nodeLinkTarget?window.open(t.LINK,t.ID).focus():"domContainerID"===a.conf.nodeLinkTarget?window.open(t.LINK,a.dom.containerId).focus():window.open(t.LINK,a.conf.nodeLinkTarget).focus()},a.tools.applyConfigurationObject=function(t){var e;for(e in t)t.hasOwnProperty(e)&&a.conf.hasOwnProperty(e)&&t[e]!==a.conf[e]&&r[e](t[e])},a.tools.zoomEventProxy=function(t){return function(){a.conf.dragMode&&(!a.conf.dragMode||"circle"===d3.event.target.tagName)||!a.conf.zoomMode||d3.event.altKey||d3.event.shiftKey||t.apply(this,arguments)}},a.tools.lassoEventProxy=function(t){return function(){a.conf.dragMode&&"circle"===d3.event.target.tagName||!a.conf.lassoMode||a.conf.zoomMode&&!d3.event.altKey&&!d3.event.shiftKey||t.apply(this,arguments)}},a.tools.showTooltip=function(t){var e;a.dom.tooltip.html(t).style("display","block"),"svgTopLeft"===a.conf.tooltipPosition?(e=a.tools.getOffsetRect(a.dom.svg.node()),a.dom.tooltip.style("top",e.top+(a.dom.svg.style("border-width")?parseInt(a.dom.svg.style("border-width")):1)+"px").style("left",e.left+(a.dom.svg.style("border-width")?parseInt(a.dom.svg.style("border-width")):1)+"px")):"svgTopRight"===a.conf.tooltipPosition?(e=a.tools.getOffsetRect(a.dom.svg.node()),a.dom.tooltip.style("top",e.top+parseInt(a.dom.svg.style("border-width")?parseInt(a.dom.svg.style("border-width")):1)+"px").style("left",e.left+parseInt(a.dom.svg.style("width"))+parseInt(a.dom.svg.style("border-width")?parseInt(a.dom.svg.style("border-width")):1)-parseInt(a.dom.tooltip.style("width"))-2*parseInt(a.dom.tooltip.style("border-width")?parseInt(a.dom.tooltip.style("border-width")):0)-parseInt(a.dom.tooltip.style("padding-left"))-parseInt(a.dom.tooltip.style("padding-right"))+"px")):a.dom.tooltip.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+"px")},a.tools.hideTooltip=function(){a.dom.tooltip.style("display","none")},a.tools.onLinkClick=function(t){if(d3.event.defaultPrevented)return null;a.tools.log("Event linkclick triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_linkclick",t),"function"==typeof a.conf.onLinkClickFunction&&a.conf.onLinkClickFunction.call(this,d3.event,t)},a.tools.getMarkerUrl=function(t){return a.conf.showLinkDirection?"url(#"+a.dom.containerId+"_"+(t.COLOR?t.COLOR:"normal")+")":null},a.tools.getMarkerUrlHighlighted=function(){return a.conf.showLinkDirection?"url(#"+a.dom.containerId+"_highlighted)":null},a.tools.onLinkMouseenter=function(t){a.conf.showTooltips&&t.INFOSTRING&&a.tools.showTooltip(t.INFOSTRING)},a.tools.onLinkMouseleave=function(){a.conf.showTooltips&&a.tools.hideTooltip()},a.tools.onNodeMouseenter=function(t){a.main.nodes.classed("highlighted",function(e){return a.tools.neighboring(e,t)}),a.main.links.classed("highlighted",function(e){return e.source.ID===t.ID||e.target.ID===t.ID}).style("marker-end",function(e){return e.source.ID===t.ID||e.target.ID===t.ID?a.tools.getMarkerUrlHighlighted(e):a.tools.getMarkerUrl(e)}),a.main.selfLinks.classed("highlighted",function(e){return e.FROMID===t.ID}).style("marker-end",function(e){return e.source.ID===t.ID||e.target.ID===t.ID?a.tools.getMarkerUrlHighlighted(e):a.tools.getMarkerUrl(e)}),a.conf.showLabels&&(a.main.labels.classed("highlighted",function(e){return e.ID===t.ID}),a.main.labelsCircular.classed("highlighted",function(e){return e.ID===t.ID})),d3.select(this).classed("highlighted",!0),a.tools.log("Event nodemouseenter triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseenter",t),"function"==typeof a.conf.onNodeMouseenterFunction&&a.conf.onNodeMouseenterFunction.call(this,d3.event,t),a.conf.showTooltips&&t.INFOSTRING&&a.tools.showTooltip(t.INFOSTRING)},a.tools.onNodeMouseleave=function(t){a.main.nodes.classed("highlighted",!1),a.main.links.classed("highlighted",!1).style("marker-end",a.tools.getMarkerUrl),a.main.selfLinks.classed("highlighted",!1).style("marker-end",a.tools.getMarkerUrl),a.conf.showLabels&&(a.main.labels.classed("highlighted",!1),a.main.labelsCircular.classed("highlighted",!1)),a.tools.log("Event nodemouseleave triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseleave",t),"function"==typeof a.conf.onNodeMouseleaveFunction&&a.conf.onNodeMouseleaveFunction.call(this,d3.event,t),a.conf.showTooltips&&a.tools.hideTooltip()},a.tools.onNodeClick=function(t){if(d3.event.defaultPrevented)return null;t.LINK&&"click"===a.conf.nodeEventToOpenLink&&a.tools.openLink(t),"click"===a.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),a.tools.log("Event nodeclick triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_click",t),"function"==typeof a.conf.onNodeClickFunction&&a.conf.onNodeClickFunction.call(this,d3.event,t)},a.tools.onNodeDblclick=function(t){t.LINK&&"dblclick"===a.conf.nodeEventToOpenLink&&a.tools.openLink(t),"dblclick"===a.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),a.tools.log("Event nodedblclick triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_dblclick",t),"function"==typeof a.conf.onNodeDblclickFunction&&a.conf.onNodeDblclickFunction.call(this,d3.event,t)},a.tools.onNodeContextmenu=function(t){a.conf.onNodeContextmenuPreventDefault&&d3.event.preventDefault(),t.LINK&&"contextmenu"===a.conf.nodeEventToOpenLink&&a.tools.openLink(t),"contextmenu"===a.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),a.tools.log("Event nodecontextmenu triggered."),a.tools.triggerApexEvent(this,"net_gobrechts_d3_force_contextmenu",t),"function"==typeof a.conf.onNodeContextmenuFunction&&a.conf.onNodeContextmenuFunction.call(this,d3.event,t)},a.tools.onLassoStart=function(t){var e={numberOfSelectedNodes:0,idsOfSelectedNodes:null};e.numberOfNodes=t.size(),e.nodes=t,a.tools.log("Event lassostart triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_lassostart",e),"function"==typeof a.conf.onLassoStartFunction&&a.conf.onLassoStartFunction.call(a.dom.svg,d3.event,e)},a.tools.onLassoEnd=function(t){var e={numberOfSelectedNodes:0,idsOfSelectedNodes:""};e.numberOfNodes=t.size(),e.nodes=t,t.each(function(t){t.selected&&(e.idsOfSelectedNodes+=t.ID+":",e.numberOfSelectedNodes++)}),e.idsOfSelectedNodes=e.idsOfSelectedNodes.length>0?e.idsOfSelectedNodes.substr(0,e.idsOfSelectedNodes.length-1):null,a.tools.log("Event lassoend triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_lassoend",e),"function"==typeof a.conf.onLassoEndFunction&&a.conf.onLassoEndFunction.call(a.dom.svg,d3.event,e)},a.tools.getOffsetRect=function(t){var e=t.getBoundingClientRect(),o=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||o.scrollTop,r=window.pageXOffset||n.scrollLeft||o.scrollLeft,s=n.clientTop||o.clientTop||0,i=n.clientLeft||o.clientLeft||0,l=e.top+a-s,d=e.left+r-i;return{top:Math.round(l),left:Math.round(d)}},a.tools.getGraphDataWithMessage=function(t){return{nodes:[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}},a.tools.getNodesDataWithMessage=function(t){return[{ID:"1",LABEL:"ERROR: "+t,COLORVALUE:"1",SIZEVALUE:"1"}]},a.tools.createLegend=function(){a.status.initialLegendHeight=a.tools.getGraphHeight(),a.data.distinctNodeColorValues.forEach(function(t,e){var o=t.split(";");a.dom.legend.append("circle").attr("cx",11).attr("cy",a.status.initialLegendHeight-(14*(e+1)-3)).attr("r",6).attr("fill",a.tools.color(o[1])),a.dom.legend.append("text").attr("x",21).attr("y",a.status.initialLegendHeight-(14*(e+1)-6)).text(o[0]?o[0]:o[1])})},a.tools.moveLegend=function(){var t=a.tools.getGraphHeight()-a.status.initialLegendHeight;a.dom.legend.attr("transform","translate(0,"+t+")")},a.tools.removeLegend=function(){a.dom.legend.selectAll("*").remove(),a.dom.legend.attr("transform",null)},a.tools.writeConfObjectIntoWizard=function(){a.status.customize&&a.dom.customizeConfObject.text(JSON.stringify(r.optionsCustomizationWizard(),null,"  "))},a.tools.createCustomizeLink=function(){!a.status.customize&&(a.conf.debug||document.querySelector("#apex-dev-toolbar")||document.querySelector("#apexDevToolbar"))&&null===document.querySelector("#"+a.dom.containerId+" svg text.link")&&a.dom.svg.append("svg:text").attr("class","link").attr("x",5).attr("y",15).attr("text-anchor","start").text("Customize Me").on("click",function(){r.customize(!0)})},a.tools.removeCustomizeLink=function(){a.dom.svg.select("#"+a.dom.containerId+" svg text.link").remove()},a.tools.customizeDrag=d3.behavior.drag().on("dragstart",function(){var t=d3.mouse(document.body);a.dom.customizePosition=a.tools.getOffsetRect(document.querySelector("#"+a.dom.containerId+"_customizing")),a.dom.customizePosition.mouseLeft=t[0]-a.dom.customizePosition.left,a.dom.customizePosition.mouseTop=t[1]-a.dom.customizePosition.top}).on("drag",function(){var t=d3.mouse(document.body);a.dom.customize.style("left",Math.max(0,t[0]-a.dom.customizePosition.mouseLeft)+"px").style("top",Math.max(0,t[1]-a.dom.customizePosition.mouseTop)+"px")}).on("dragend",function(){a.dom.customizePosition=a.tools.getOffsetRect(a.dom.customize.node())}),a.tools.createCustomizeWizardIfNotRendering=function(){a.status.customize&&!a.status.graphRendering&&a.tools.createCustomizeWizard()},a.tools.createCustomizeWizard=function(){var t,e,o,n,s,i,l,d,c,u=4,f=function(){r.releaseFixedNodes().resume()},g=function(){a.status.customizeCurrentTabPosition=this.id,"text"===a.confDefaults[this.name].type?r[this.name](this.options[this.selectedIndex].value).render():"number"===a.confDefaults[this.name].type?r[this.name](parseFloat(this.options[this.selectedIndex].value)).render():"bool"===a.confDefaults[this.name].type&&r[this.name]("true"===this.options[this.selectedIndex].value).render()},p=function(t){a.confDefaults[t].options.forEach(function(e){l=e,i.append("option").attr("value",e).attr("selected",function(){return"text"===a.confDefaults[t].type||"bool"===a.confDefaults[t].type?l===a.conf[t]?(d=!0,"selected"):null:"number"===a.confDefaults[t].type?parseFloat(l)===a.conf[t]?(d=!0,"selected"):null:void 0}).text(e)})};if(a.status.customize){for(c in a.tools.removeCustomizeLink(),a.dom.customizePosition||(a.dom.customizePosition=a.tools.getOffsetRect(a.dom.svg.node()),a.dom.customizePosition.top=a.dom.customizePosition.top+100,a.dom.customizePosition.left=a.dom.customizePosition.left+200),null!==document.querySelector("#"+a.dom.containerId+"_customizing")&&a.dom.customize.remove(),a.dom.customize=a.dom.body.insert("div").attr("id",a.dom.containerId+"_customizing").attr("class","net_gobrechts_d3_force_customize").style("left",a.dom.customizePosition.left+"px").style("top",a.dom.customizePosition.top+"px"),a.dom.customize.append("span").attr("class","drag").call(a.tools.customizeDrag).append("span").attr("class","title").text('Customize "'+a.dom.containerId+'"'),a.dom.customize.append("a").attr("class","close focus").attr("tabindex",1).text("Close").on("click",function(){a.status.customize=!1,a.tools.removeCustomizeWizard(),a.tools.createCustomizeLink()}).on("keydown",function(){13===d3.event.keyCode&&(a.status.customize=!1,a.tools.removeCustomizeWizard(),a.tools.createCustomizeLink())}),o=(e=(t=a.dom.customize.append("table")).append("tr")).append("td").style("vertical-align","top"),a.dom.customizeMenu=o.append("span"),a.dom.customizeOptionsTable=o.append("table"),a.confDefaults)a.confDefaults.hasOwnProperty(c)&&a.confDefaults[c].display&&(u+=1,(n=a.dom.customizeOptionsTable.append("tr").attr("class",a.confDefaults[c].relation+"-related")).append("td").attr("class","label").html('<a href="https://ogobrecht.github.io/d3-force-apex-plugin/module-API.html#.'+c+'" target="github_d3_force" tabindex="'+u+'100">'+c+"</a>"),s=n.append("td"),i=s.append("select").attr("id",a.dom.containerId+"_"+c).attr("name",c).attr("value",a.conf[c]).attr("tabindex",u+1).classed("warning",a.confDefaults[c].internal).on("change",g),d=!1,p(c),d||(i.append("option").attr("value",a.conf[c]).attr("selected","selected").text(a.conf[c]),a.confDefaults[c].options.push(a.conf[c])),"pinMode"===c&&s.append("a").text(" release all").attr("href",null).on("click",f));a.dom.customizeOptionsTable.style("width",d3.select(a.dom.customizeOptionsTable).node()[0][0].clientWidth+"px"),o.append("span").html("<br>"),(o=e.append("td").style("vertical-align","top").style("padding-left","5px")).append("span").html('Your Configuration Object<p style="font-size:10px;margin:0;">'+(a.status.apexPluginId?"To save your options please copy<br>this to your plugin region attributes.<br>Only non-default options are shown.</p>":"Use this to initialize your graph.<br>Only non-default options are shown.</p>")),a.dom.customizeConfObject=o.append("textarea").attr("tabindex",u+5).attr("readonly","readonly"),o.append("span").html("<br><br>Current Positions<br>"),a.dom.customizePositions=o.append("textarea").attr("tabindex",u+6).attr("readonly","readonly").text(a.status.forceRunning?"Force started - wait for end event to show positions...":JSON.stringify(r.positions())),o.append("span").html("<br><br>Debug Log (descending)<br>"),a.dom.customizeLog=o.append("textarea").attr("tabindex",u+7).attr("readonly","readonly"),o=(e=t.append("tr")).append("td").attr("colspan",2).html("Copyrights:"),o=(e=t.append("tr")).append("td").attr("colspan",2).html('<table><tr><td style="padding-right:20px;"><a href="https://github.com/ogobrecht/d3-force-apex-plugin" target="_blank" tabindex="'+(u+8)+'">D3 Force APEX Plugin</a> ('+a.version+')<br>Ottmar Gobrecht</td><td style="padding-right:20px;"><a href="https://github.com/mbostock/d3" target="d3js_org" tabindex="'+(u+9)+'">D3.js</a> ('+d3.version+') and <a href="https://github.com/d3/d3-plugins/tree/master/lasso" target="_blank" tabindex="'+(u+10)+'">D3 Lasso Plugin</a> (modified)<br>Mike Bostock</td></tr><tr><td colspan="3"><a href="https://github.com/tinker10/D3-Labeler" target="github_d3_labeler" tabindex="'+(u+11)+'">D3 Labeler Plugin</a> (automatic label placement using simulated annealing)<br>Evan Wang</td></tr></table>'),a.tools.createCustomizeMenu(a.status.customizeCurrentMenu),a.tools.writeConfObjectIntoWizard(),a.status.customizeCurrentTabPosition&&document.getElementById(a.status.customizeCurrentTabPosition).focus()}else a.tools.removeCustomizeWizard(),a.tools.createCustomizeLink()},a.tools.removeCustomizeWizard=function(){d3.select("#"+a.dom.containerId+"_customizing").remove()},a.tools.createCustomizeMenu=function(t){a.status.customizeCurrentMenu=t,a.dom.customizeMenu.selectAll("*").remove(),a.dom.customizeMenu.append("span").text("Show options for:"),"nodes"===a.status.customizeCurrentMenu?(a.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("NODES"),a.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.label-related,tr.link-related,tr.graph-related").classed("hidden",!0)):a.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("NODES").attr("tabindex",2).on("click",function(){a.tools.createCustomizeMenu("nodes"),a.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.label-related,tr.link-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(a.tools.createCustomizeMenu("nodes"),a.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.label-related,tr.link-related,tr.graph-related").classed("hidden",!0))}),"labels"===a.status.customizeCurrentMenu?(a.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("LABELS"),a.dom.customizeOptionsTable.selectAll("tr.label-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related,tr.graph-related").classed("hidden",!0)):a.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("LABELS").attr("tabindex",2).on("click",function(){a.tools.createCustomizeMenu("labels"),a.dom.customizeOptionsTable.selectAll("tr.label-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(a.tools.createCustomizeMenu("labels"),a.dom.customizeOptionsTable.selectAll("tr.label-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related,tr.graph-related").classed("hidden",!0))}),"links"===a.status.customizeCurrentMenu?(a.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("LINKS"),a.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.graph-related").classed("hidden",!0)):a.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("LINKS").attr("tabindex",3).on("click",function(){a.tools.createCustomizeMenu("links"),a.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(a.tools.createCustomizeMenu("links"),a.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.graph-related").classed("hidden",!0))}),"graph"===a.status.customizeCurrentMenu?(a.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("GRAPH"),a.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.link-related").classed("hidden",!0)):a.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("GRAPH").attr("tabindex",4).on("click",function(){a.tools.createCustomizeMenu("graph"),a.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.link-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(a.tools.createCustomizeMenu("graph"),a.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),a.dom.customizeOptionsTable.selectAll("tr.node-related,tr.label-related,tr.link-related").classed("hidden",!0))}),a.dom.customizeMenu.append("span").html("<br><br>")},a.tools.wrapLabels=function(t,e){t.each(function(t,o){var n=d3.select(this);if(0===o&&(a.status.labelFontSize=parseInt(n.style("font-size"))),!this.hasAttribute("lines")){var r,s=n.text().split("none"!==a.conf.labelSplitCharacter?a.conf.labelSplitCharacter:/\s+/).reverse(),i=[],l=0,d=a.status.labelFontSize*a.conf.wrappedLabelLineHeight,c=n.attr("x"),u=n.attr("y"),f=n.text(null).append("tspan").attr("x",c).attr("y",u).attr("dy","0px");if("none"!==a.conf.labelSplitCharacter)for(;r=s.pop();)f=n.append("tspan").attr("x",c).attr("y",u).attr("dy",++l*d+0+"px").text(r);else for(;r=s.pop();)i.push(r),f.text(i.join(" ")),f.node().getComputedTextLength()>e&&(i.pop(),f.text(i.join(" ")),i=[r],f=n.append("tspan").attr("x",c).attr("y",u).attr("dy",++l*d+0+"px").text(r));n.attr("lines",l+1)}})},a.lib.labelerPlugin=function(){var t,e=[],o=[],n=1,a=1,r={},s=!1,i=function(t){var n=e.length,a=0,r=e[t].x-o[t].x,s=o[t].y-e[t].y,i=Math.sqrt(r*r+s*s);i>0&&(a+=.2*i),s/=i,a+=(r/=i)>0&&s>0?0:r<0&&s>0?1:r<0&&s<0?2:3;for(var l,d,u,f,g=e[t].x,p=e[t].y-e[t].height+2,h=e[t].x+e[t].width,m=e[t].y+2,L=0;L<n;L++)L!==t&&(c(o[t].x,e[t].x,o[L].x,e[L].x,o[t].y,e[t].y,o[L].y,e[L].y)&&(a+=1),l=e[L].x,u=e[L].y-e[L].height+2,d=e[L].x+e[L].width,f=e[L].y+2,a+=30*(Math.max(0,Math.min(d,h)-Math.max(l,g))*Math.max(0,Math.min(f,m)-Math.max(u,p)))),l=o[L].x-o[L].r,u=o[L].y-o[L].r,d=o[L].x+o[L].r,f=o[L].y+o[L].r,a+=30*(Math.max(0,Math.min(d,h)-Math.max(l,g))*Math.max(0,Math.min(f,m)-Math.max(u,p)));return a},l=function(r){var l,d=Math.floor(Math.random()*e.length),c=e[d].x,u=e[d].y;l=s?t(d,e,o):i(d),e[d].x+=5*(Math.random()-.5),e[d].y+=5*(Math.random()-.5),e[d].x>n&&(e[d].x=c),e[d].x<0&&(e[d].x=c),e[d].y>a&&(e[d].y=u),e[d].y<0&&(e[d].y=u);var f=(s?t(d,e,o):i(d))-l;Math.random()<Math.exp(-f/r)?1:(e[d].x=c,e[d].y=u,1)},d=function(r){var l,d=Math.floor(Math.random()*e.length),c=e[d].x,u=e[d].y;l=s?t(d,e,o):i(d);var f=.5*(Math.random()-.5),g=Math.sin(f),p=Math.cos(f);e[d].x-=o[d].x,e[d].y-=o[d].y;var h=e[d].x*p-e[d].y*g,m=e[d].x*g+e[d].y*p;e[d].x=h+o[d].x,e[d].y=m+o[d].y,e[d].x>n&&(e[d].x=c),e[d].x<0&&(e[d].x=c),e[d].y>a&&(e[d].y=u),e[d].y<0&&(e[d].y=u);var L=(s?t(d,e,o):i(d))-l;Math.random()<Math.exp(-L/r)?1:(e[d].x=c,e[d].y=u,1)},c=function(t,e,o,n,a,r,s,i){var l,d,c;return d=((e-t)*(a-s)-(r-a)*(t-o))/(c=(i-s)*(e-t)-(n-o)*(r-a)),!((l=((n-o)*(a-s)-(i-s)*(t-o))/c)<0||l>1||d<0||d>1)},u=function(t,e,o){return t-e/o};return r.start=function(t){for(var o=e.length,n=1,a=0;a<t;a++){for(var r=0;r<o;r++)Math.random()<.5?l(n):d(n);n=u(n,1,t)}},r.width=function(t){return arguments.length?(n=t,r):n},r.height=function(t){return arguments.length?(a=t,r):a},r.label=function(t){return arguments.length?(e=t,r):e},r.anchor=function(t){return arguments.length?(o=t,r):o},r.alt_energy=function(e){return arguments.length?(t=e,s=!0,r):i},r.alt_schedule=function(t){return arguments.length?(t,!0,r):u},r},a.lib.lassoPlugin=function(){var t=null,e=75,o=!0,n=!1,a=!0,r=null,s=null,i={start:function(){},draw:function(){},end:function(){}};function l(){var l,c,u,f,g,p,h,m,L,v=d3.select(this[0][0]);0===(s=s||v).selectAll("g.lasso").size()?(l=s.append("g").attr("class","lasso"),c=l.append("path").attr("class","drawn"),u=l.append("path").attr("class","loop_close"),f=l.append("path").attr("class","complete_path").attr("display","none")):(l=s.select("g.lasso"),c=l.select("path.drawn"),u=l.select("path.loop_close"),f=l.select("path.complete_path")),L=d3.behavior.drag().on("dragstart",function(){g="",c.attr("d",null),u.attr("d",null),m=0,t[0].forEach(function(t){t.hoverSelected=!1,t.loopSelected=!1;var e=t.getBBox(),o=t.getCTM();t.lassoPoint={cx:Math.round((e.x+e.width/2)*o.a+o.e),cy:Math.round((e.y+e.height/2)*o.d+o.f),edges:{top:0,right:0,bottom:0,left:0},close_edges:{left:0,right:0}}}),!0===a&&t.on("mouseover.lasso",function(){d3.select(this)[0][0].hoverSelected=!0}),i.start()}).on("drag",function(){var a,r,s,l,L,v,y,b,x,z,D,k,I=d3.mouse(this)[0],O=d3.mouse(this)[1],C=function(t){k.x>t.lassoPoint.cx&&(t.lassoPoint.edges.right=t.lassoPoint.edges.right+1),k.x<t.lassoPoint.cx&&(t.lassoPoint.edges.left=t.lassoPoint.edges.left+1)},S=function(t){Math.round(D.y)!==Math.round(x.y)&&Math.round(D.x)>t.lassoPoint.cx&&(t.lassoPoint.close_edges.right=1),Math.round(D.y)!==Math.round(x.y)&&Math.round(D.x)<t.lassoPoint.cx&&(t.lassoPoint.close_edges.left=1)},E=function(t){return t.lassoPoint.cy===Math.round(D.y)},R=function(t){var e;return t.lassoPoint.cy===k.y&&t.lassoPoint.cy!==z.y?(h={x:z.x,y:z.y},e=!1):t.lassoPoint.cy===k.y&&t.lassoPoint.cy===z.y?e=!1:t.lassoPoint.cy===z.y&&t.lassoPoint.cy!==k.y?e=d(t.lassoPoint.cy-k.y)!==d(t.lassoPoint.cy-h.y):(h={x:z.x,y:z.y},e=d(t.lassoPoint.cy-k.y)!==d(t.lassoPoint.cy-z.y)),e};for(""===g?(g=g+"M "+I+" "+O,p=[I,O]):g=g+" L "+I+" "+O,t[0].forEach(function(t){t.lassoPoint.close_edges={left:0,right:0}}),a=Math.sqrt(Math.pow(I-p[0],2)+Math.pow(O-p[1],2)),r="M "+I+" "+O+" L "+p[0]+" "+p[1],c.attr("d",g),a<=e?u.attr("display",null):u.attr("display","none"),n=a<=e,s=d3.select("path")[0][0].attributes.d.value+"Z",f.attr("d",s),y=(v=c.node()).getTotalLength(),v.getPointAtLength(m-1),b=m;b<=y;b++)D=v.getPointAtLength(b),k={x:Math.round(100*D.x)/100,y:Math.round(100*D.y)/100},x=v.getPointAtLength(b-1),z={x:Math.round(100*x.x)/100,y:Math.round(100*x.y)/100},t[0].filter(R).forEach(C);if(!0===n&&!0===o){for(u.attr("d",r),L=(l=u.node()).getTotalLength(),b=0;b<=L;b++)D=l.getPointAtLength(b),x=l.getPointAtLength(b-1),t[0].filter(E).forEach(S);t[0].forEach(function(t){t.lassoPoint.edges.left+t.lassoPoint.close_edges.left>0&&(t.lassoPoint.edges.right+t.lassoPoint.close_edges.right)%2==1?t.loopSelected=!0:t.loopSelected=!1})}else t[0].forEach(function(t){t.loopSelected=!1});d3.selectAll(t[0].filter(function(t){return t.loopSelected&&n||t.hoverSelected})).attr("d",function(t){return t.possible=!0,t.possible}),d3.selectAll(t[0].filter(function(t){return!(t.loopSelected&&n||t.hoverSelected)})).attr("d",function(t){return t.possible=!1,t.possible}),i.draw(),m=y+1}).on("dragend",function(){t.on("mouseover.lasso",null),t.filter(function(t){return!0===t.possible}).attr("d",function(t){return t.selected=!0,t.selected}),t.filter(function(t){return!1===t.possible}).attr("d",function(t){return t.selected=!1,t.selected}),t.attr("d",function(t){return t.possible=!1,t.possible}),c.attr("d",null),u.attr("d",null),i.end()}),r.call(L)}function d(t){return t?t<0?-1:1:0}return l.items=function(e){return arguments.length?((t=e)[0].forEach(function(t){var e=d3.select(t);void 0===e.datum()?e.datum({possible:!1,selected:!1}):e.attr("d",function(t){return t.possible=!1,t.selected=!1,t})}),l):t},l.closePathDistance=function(t){return arguments.length?(e=t,l):e},l.closePathSelect=function(t){return arguments.length?(o=!0===t,l):o},l.isPathClosed=function(t){return arguments.length?(n=!0===t,l):n},l.hoverSelect=function(t){return arguments.length?(a=!0===t,l):a},l.on=function(t,e){if(!arguments.length)return i;if(1===arguments.length)return i[t];return["start","draw","end"].indexOf(t)>-1&&(i[t]=e),l},l.area=function(t){return arguments.length?(r=t,l):r},l.pathContainer=function(t){return arguments.length?(s=d3.select(t[0][0]),l):s},l},r.start=function(t){var e;return t?r.render(t):a.status.apexPluginId?(a.conf.showLoadingIndicatorOnAjaxCall&&r.showLoadingIndicator(!0),apex.server.plugin(a.status.apexPluginId,{p_debug:$v("pdebug"),pageItems:a.status.apexPageItemsToSubmit},{success:function(t){a.conf.showLoadingIndicatorOnAjaxCall&&r.showLoadingIndicator(!1),"<"===(e=t.trim().substr(0,1))||"{"===e?r.render(t.trim()):"no_query_defined"===t.trim().substr(0,16)?(a.tools.logError("No query defined."),r.render()):"query_returned_no_data"===t.trim().substr(0,22)?(a.tools.logError("Query returned no data."),r.render({data:{nodes:[{ID:"1",LABEL:"ERROR: No data.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}})):(a.tools.logError(t),r.render({data:{nodes:[{ID:"1",LABEL:"ERROR: "+t+".",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}))},error:function(t,e,o){a.tools.logError("AJAX call terminated with errors: "+o+"."),r.render({data:{nodes:[{ID:"1",LABEL:"AJAX call terminated with errors.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}})},dataType:"text"})):r.render(),r},r.render=function(t){var e;if(a.status.graphStarted=!0,a.status.graphRendering=!0,a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"apexbeforerefresh"),t?a.status.sampleData=!1:t||a.status.graphReady||(a.tools.logError("Houston, we have a problem - we have to provide sample data."),a.status.sampleData=!0,t=a.data.sampleData),t){if(a.status.graphReady&&(a.status.graphOldPositions=r.positions()),t.constructor===Object)a.data.dataConverted=t,a.conf.debug&&(a.tools.log("Data object:"),a.tools.log(a.data.dataConverted,!0));else if(t.constructor===String){if("<"===t.trim().substr(0,1))try{a.data.dataConverted=a.tools.xmlToJson(a.tools.parseXml(t)),null===a.data.dataConverted&&(e="Unable to convert XML string.",a.tools.logError(e),a.data.dataConverted=a.tools.getGraphDataWithMessage(e))}catch(t){e="Unable to convert XML string: "+t.message+".",a.tools.logError(e),a.data.dataConverted=a.tools.getGraphDataWithMessage(e)}else if("{"===t.trim().substr(0,1))try{a.data.dataConverted=JSON.parse(t)}catch(t){e="Unable to parse JSON string: "+t.message+".",a.tools.logError(e),a.data.dataConverted=a.tools.getGraphDataWithMessage(e)}else e='Your data string is not starting with "<" or "{" - parsing not possible.',a.tools.logError(e),a.data.dataConverted=a.tools.getGraphDataWithMessage(e);a.conf.debug&&(a.tools.log("Data string:"),a.tools.log(t,!0),a.tools.log("Converted data object:"),a.tools.log(a.data.dataConverted,!0))}else e="Unable to parse your data - input data can be a XML string, JSON string or JavaScript object.",a.tools.logError(e),a.data.dataConverted=a.tools.getGraphDataWithMessage(e);null!==a.data.dataConverted?a.data.dataConverted.hasOwnProperty("data")&&null!==a.data.dataConverted.data?(a.data.dataConverted.data.hasOwnProperty("nodes")&&null!==a.data.dataConverted.data.nodes?(a.data.nodes=a.data.dataConverted.data.nodes,0===a.data.nodes.length&&(e="Your data contains an empty nodes array.",a.tools.logError(e),a.data.nodes=a.tools.getNodesDataWithMessage(e))):(e="Your data contains no nodes.",a.tools.logError(e),a.data.nodes=a.tools.getNodesDataWithMessage(e)),a.data.dataConverted.data.hasOwnProperty("links")&&null!==a.data.dataConverted.data.links?a.data.links=a.data.dataConverted.data.links:a.data.links=[]):(e="Missing root element named data.",a.tools.logError(e),a.data=a.tools.getGraphDataWithMessage(e)):(e="Unable to parse your data - please consult the API reference for possible data formats.",a.tools.logError(e),a.data=a.tools.getGraphDataWithMessage(e)),a.data.idLookup=[],a.data.nodes.forEach(function(t){t.SIZEVALUE=parseFloat(t.SIZEVALUE),t.LABELCIRCULAR=a.tools.parseBool(t.LABELCIRCULAR),t.fixed&&(t.fixed=a.tools.parseBool(t.fixed)),t.x&&(t.x=parseFloat(t.x)),t.y&&(t.y=parseFloat(t.y)),a.data.idLookup[t.ID]=t}),a.data.links.forEach(function(t){t.source=a.data.idLookup[t.FROMID],t.target=a.data.idLookup[t.TOID]}),a.data.links=a.data.links.filter(function(t){return void 0!==t.source&&void 0!==t.target}),a.data.neighbors=a.data.links.map(function(t){return t.FROMID+":"+t.TOID}),a.data.distinctNodeColorValues=a.data.nodes.map(function(t){return(t.COLORLABEL?t.COLORLABEL:"")+";"+t.COLORVALUE}).filter(function(t,e,o){return o.indexOf(t)===e}).sort(function(t,e){var o=t.toLowerCase(),n=e.toLowerCase();return o<n?1:o>n?-1:0}),a.data.distinctLinkColorValues=a.data.links.map(function(t){return t.COLOR}).filter(Boolean).filter(function(t,e,o){return o.indexOf(t)===e}).sort(function(t,e){var o=t.toLowerCase(),n=e.toLowerCase();return o<n?1:o>n?-1:0}),a.conf.positions?a.conf.positions.constructor===Array?a.conf.positions.forEach(function(t){void 0!==a.data.idLookup[t.ID]&&(a.data.idLookup[t.ID].fixed||(a.data.idLookup[t.ID].fixed=t.fixed),a.data.idLookup[t.ID].x||(a.data.idLookup[t.ID].x=a.data.idLookup[t.ID].px=t.x),a.data.idLookup[t.ID].y||(a.data.idLookup[t.ID].y=a.data.idLookup[t.ID].py=t.y))}):a.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):a.status.graphOldPositions&&a.status.graphOldPositions.forEach(function(t){void 0!==a.data.idLookup[t.ID]&&(a.data.idLookup[t.ID].fixed||(a.data.idLookup[t.ID].fixed=t.fixed),a.data.idLookup[t.ID].x||(a.data.idLookup[t.ID].x=a.data.idLookup[t.ID].px=t.x),a.data.idLookup[t.ID].y||(a.data.idLookup[t.ID].y=a.data.idLookup[t.ID].py=t.y))}),a.conf.positions=null,a.status.graphOldPositions=null}a.tools.setColorFunction(),a.tools.setRadiusFunction(),a.data.nodes.forEach(function(t){t.radius=a.tools.radius(t.SIZEVALUE)}),a.main.markers=a.dom.defs.selectAll("marker.custom").data(a.data.distinctLinkColorValues,function(t){return t}),a.main.markers.enter().append("svg:marker").attr("id",function(t){return a.dom.containerId+"_"+t}).attr("class","custom").attr("stroke","none").attr("fill",function(t){return t}).attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),a.main.markers.exit().remove(),a.main.links=a.dom.graph.selectAll("path.link_sq").data(a.data.links.filter(function(t){return t.FROMID!==t.TOID}),function(t){return a.tools.getLinkId(t)}),a.main.links.enter().append("svg:path").attr("class","link_sq").on("mouseenter",a.tools.onLinkMouseenter).on("mouseleave",a.tools.onLinkMouseleave).on("click",a.tools.onLinkClick),a.main.links.exit().remove(),a.main.links.style("marker-end",a.tools.getMarkerUrl).classed("dotted",function(t){return"dotted"===t.STYLE}).classed("dashed",function(t){return"dashed"===t.STYLE}).style("stroke",function(t){return t.COLOR?t.COLOR:null}),a.main.selfLinks=a.dom.graph.selectAll("path.link").data(a.data.links.filter(function(t){return t.FROMID===t.TOID&&a.conf.showSelfLinks}),function(t){return a.tools.getLinkId(t)}),a.main.selfLinks.enter().append("svg:path").attr("id",function(t){return a.tools.getPathId(t)}).attr("class","link").on("mouseenter",a.tools.onLinkMouseenter).on("mouseleave",a.tools.onLinkMouseleave).on("click",a.tools.onLinkClick),a.main.selfLinks.exit().remove(),a.main.selfLinks.attr("d",function(t){return a.tools.getSelfLinkPath(t)}).style("marker-end",a.tools.getMarkerUrl).classed("dotted",function(t){return"dotted"===t.STYLE}).classed("dashed",function(t){return"dashed"===t.STYLE}).style("stroke",function(t){return t.COLOR?t.COLOR:null}),a.main.patterns=a.dom.defs.selectAll("pattern").data(a.data.nodes.filter(function(t){return!!t.IMAGE}),function(t){return t.ID});var o=a.main.patterns.enter().append("svg:pattern").attr("id",function(t){return a.tools.getPatternId(t)});return o.append("svg:rect"),o.append("svg:image"),o="",a.main.patterns.exit().remove(),a.main.patterns.each(function(){d3.select(this).attr("x",0).attr("y",0).attr("height",1).attr("width",1),d3.select(this.firstChild).attr("x",0).attr("y",0).attr("height",function(t){return 2*t.radius}).attr("width",function(t){return 2*t.radius}).attr("fill",function(t){return a.tools.color(t.COLORVALUE)}),d3.select(this.lastChild).attr("x",0).attr("y",0).attr("height",function(t){return 2*t.radius}).attr("width",function(t){return 2*t.radius}).attr("xlink:href",function(t){return t.IMAGE})}),a.main.nodes=a.dom.graph.selectAll("circle.node").data(a.data.nodes,function(t){return t.ID}),a.main.nodes.enter().append("svg:circle").attr("class","node").attr("cx",function(t){if(!t.fixed&&!t.x)return t.x=Math.floor(Math.random()*a.tools.getGraphWidth()+1),t.x}).attr("cy",function(t){if(!t.fixed&&!t.y)return t.y=Math.floor(Math.random()*a.conf.height+1),t.y}).on("mouseenter",a.tools.onNodeMouseenter).on("mouseleave",a.tools.onNodeMouseleave).on("click",a.tools.onNodeClick).on("dblclick",a.tools.onNodeDblclick).on("contextmenu",a.tools.onNodeContextmenu),a.main.nodes.exit().remove(),a.main.nodes.attr("r",function(t){return t.radius}).attr("fill",function(t){return t.IMAGE?"url(#"+a.tools.getPatternId(t)+")":a.tools.color(t.COLORVALUE)}),a.conf.showLabels?(a.main.linkLabelPaths=a.dom.defs.selectAll("path.linkLabel").data(a.data.links.filter(function(t){return t.LABEL&&t.FROMID!==t.TOID}),function(t){return a.tools.getLinkId(t)}),a.main.linkLabelPaths.enter().append("svg:path").attr("id",function(t){return a.tools.getPathId(t)}).attr("class","linkLabel"),a.main.linkLabelPaths.exit().remove(),a.main.linkLabelPaths.attr("d",function(t){return"M "+t.source.x+" "+t.source.y+" L "+t.target.x+" "+t.target.y}),a.main.linkLabels=a.dom.graph.selectAll("text.linkLabel").data(a.data.links.filter(function(t){return t.LABEL}),function(t){return a.tools.getLinkId(t)}),a.main.linkLabels.enter().append("svg:text").attr("class","linkLabel").attr("dx",function(t){return t.FROMID!==t.TOID?a.conf.linkDistance/2:a.conf.selfLinkDistance+t.source.radius}).attr("dy","-1").on("mouseenter",a.tools.onLinkMouseenter).on("mouseleave",a.tools.onLinkMouseleave).on("click",a.tools.onLinkClick).append("svg:textPath").attr("xlink:href",function(t){return"#"+a.tools.getPathId(t)}),a.main.linkLabels.exit().remove(),a.main.linkLabels.each(function(t){d3.select(this.firstChild).text(t.LABEL)}),a.main.labels=a.dom.graph.selectAll("text.label").data(a.data.nodes.filter(function(t){return!t.LABELCIRCULAR&&!a.conf.labelsCircular}),function(t){return t.ID}),a.main.labels.enter().append("svg:text").attr("class","label"),a.main.labels.exit().remove(),a.main.labels.text(function(t){return t.LABEL}),a.main.labelPaths=a.dom.defs.selectAll("path.label").data(a.data.nodes.filter(function(t){return t.LABELCIRCULAR||a.conf.labelsCircular}),function(t){return t.ID}),a.main.labelPaths.enter().append("svg:path").attr("id",function(t){return a.dom.containerId+"_textPath_"+t.ID}).attr("class","label"),a.main.labelPaths.exit().remove(),a.main.labelPaths.attr("d",function(t){return a.tools.getLabelPath(t)}),a.main.labelsCircular=a.dom.graph.selectAll("text.labelCircular").data(a.data.nodes.filter(function(t){return t.LABELCIRCULAR||a.conf.labelsCircular}),function(t){return t.ID}),a.main.labelsCircular.enter().append("svg:text").attr("class","labelCircular").append("svg:textPath").attr("xlink:href",function(t){return"#"+a.dom.containerId+"_textPath_"+t.ID}),a.main.labelsCircular.exit().remove(),a.main.labelsCircular.each(function(t){d3.select(this.firstChild).text(t.LABEL)})):(a.dom.defs.selectAll("path.label,path.linkLabel").remove(),a.dom.graph.selectAll("text.label,text.labelCircular,text.linkLabel").remove()),a.status.aspectRatio||(a.status.aspectRatio=a.conf.width/a.conf.height),a.tools.removeLegend(),a.conf.showLegend&&a.tools.createLegend(),a.tools.executeResize(),r.debug(a.conf.debug).showBorder(a.conf.showBorder).setDomParentPaddingToZero(a.conf.setDomParentPaddingToZero).useDomParentWidth(a.conf.useDomParentWidth).alignFixedNodesToGrid(a.conf.alignFixedNodesToGrid).wrapLabels(a.conf.wrapLabels).dragMode(a.conf.dragMode).pinMode(a.conf.pinMode).lassoMode(a.conf.lassoMode).zoomMode(a.conf.zoomMode).transform(a.conf.transform).autoRefresh(a.conf.autoRefresh).linkDistance(a.conf.linkDistance).charge(a.conf.charge).chargeDistance(a.conf.chargeDistance).gravity(a.conf.gravity).linkStrength(a.conf.linkStrength).friction(a.conf.friction).theta(a.conf.theta),a.main.force.nodes(a.data.nodes).links(a.data.links).size([a.tools.getGraphWidth(),a.tools.getGraphHeight()]).start(),a.status.graphReady=!0,a.status.graphRendering=!1,a.status.customize?a.tools.createCustomizeWizard():a.tools.createCustomizeLink(),a.tools.log("Event renderend triggered."),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"net_gobrechts_d3_force_renderend"),"function"==typeof a.conf.onRenderEndFunction&&a.conf.onRenderEndFunction.call(a.dom.svg),a.tools.triggerApexEvent(document.querySelector("#"+a.dom.containerId),"apexafterrefresh"),r},r.resume=function(){return a.status.graphReady&&a.main.force.resume(),a.tools.createCustomizeWizardIfNotRendering(),r},r.showBorder=function(t){return arguments.length?(a.conf.showBorder=t,a.status.graphStarted&&(a.dom.svg.classed("border",a.conf.showBorder),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.showBorder},r.showLegend=function(t){return arguments.length?(a.conf.showLegend=t,a.status.graphStarted&&(a.conf.showLegend?(a.tools.removeLegend(),a.tools.createLegend()):a.tools.removeLegend(),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.showLegend},r.showSelfLinks=function(t){return arguments.length?(a.conf.showSelfLinks=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.showSelfLinks},r.showLinkDirection=function(t){return arguments.length?(a.conf.showLinkDirection=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.showLinkDirection},r.showTooltips=function(t){return arguments.length?(a.conf.showTooltips=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.showTooltips},r.tooltipPosition=function(t){return arguments.length?(a.conf.tooltipPosition=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.tooltipPosition},r.colorScheme=function(t){return arguments.length?(a.conf.colorScheme=t,a.tools.setColorFunction(),a.status.graphStarted&&(a.main.nodes.attr("fill",function(t){return t.IMAGE?"url(#"+a.tools.getPatternId(t)+")":a.tools.color(t.COLORVALUE)}),a.conf.showLegend&&(a.tools.removeLegend(),a.tools.createLegend()),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.colorScheme},r.showLabels=function(t){return arguments.length?(a.conf.showLabels=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.showLabels},r.wrapLabels=function(t){return arguments.length?(a.conf.wrapLabels=t,a.conf.wrapLabels&&(a.status.wrapLabelsOnNextTick=!0),a.status.graphStarted&&(a.main.labels.attr("lines",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.wrapLabels},r.labelSplitCharacter=function(t){return arguments.length?(a.conf.labelSplitCharacter=t,a.conf.wrapLabels&&(a.status.wrapLabelsOnNextTick=!0),a.status.graphStarted&&(a.main.labels.attr("lines",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.labelSplitCharacter},r.wrappedLabelWidth=function(t){return arguments.length?(a.conf.wrappedLabelWidth=t,a.conf.wrapLabels&&(a.main.labels.attr("lines",null),a.status.wrapLabelsOnNextTick=!0),a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.wrappedLabelWidth},r.wrappedLabelLineHeight=function(t){return arguments.length?(a.conf.wrappedLabelLineHeight=t,a.conf.wrapLabels&&(a.status.wrapLabelsOnNextTick=!0),a.status.graphStarted&&(a.main.labels.attr("lines",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.wrappedLabelLineHeight},r.labelsCircular=function(t){return arguments.length?(a.conf.labelsCircular=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.labelsCircular},r.labelDistance=function(t){return arguments.length?(a.conf.labelDistance=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.labelDistance},r.preventLabelOverlappingOnForceEnd=function(t){return arguments.length?(a.conf.preventLabelOverlappingOnForceEnd=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.preventLabelOverlappingOnForceEnd},r.labelPlacementIterations=function(t){return arguments.length?(a.conf.labelPlacementIterations=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.labelPlacementIterations},r.dragMode=function(t){return arguments.length?(a.conf.dragMode=t,a.status.graphStarted&&(a.conf.dragMode?a.main.nodes.call(a.main.drag):(a.main.nodes.on("mousedown.drag",null),a.main.nodes.on("touchstart.drag",null)),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.dragMode},r.pinMode=function(t){return arguments.length?(a.conf.pinMode=t,a.status.graphStarted&&(a.conf.pinMode?a.main.drag.on("dragstart",function(t){d3.select(this).classed("fixed",t.fixed=1)}):a.main.drag.on("dragstart",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.pinMode},r.lassoMode=function(t){return arguments.length?(a.conf.lassoMode=t,a.status.graphStarted&&(a.conf.lassoMode?(a.dom.graphOverlay.call(a.main.lasso),a.main.lasso.items(a.main.nodes),a.main.lasso.on("start",function(){a.main.lasso.items().classed("selected",!1),a.tools.onLassoStart(a.main.lasso.items())}),a.main.lasso.on("draw",function(){a.main.lasso.items().filter(function(t){return!0===t.possible}).classed("selected",!0),a.main.lasso.items().filter(function(t){return!1===t.possible}).classed("selected",!1)}),a.main.lasso.on("end",function(){a.main.lasso.items().filter(function(t){return!0===t.selected}).classed("selected",!0),a.main.lasso.items().filter(function(t){return!1===t.selected}).classed("selected",!1),a.tools.onLassoEnd(a.main.lasso.items())}),a.events.mousedownLasso=a.dom.graphOverlay.on("mousedown.drag"),a.events.touchstartLasso=a.dom.graphOverlay.on("touchstart.drag"),a.dom.graphOverlay.on("mousedown.drag",a.tools.lassoEventProxy(a.events.mousedownLasso)),a.dom.graphOverlay.on("touchstart.drag",a.tools.lassoEventProxy(a.events.touchstartLasso))):(a.dom.graphOverlay.on(".drag",null),a.main.nodes.classed("selected",!1)),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.lassoMode},r.zoomMode=function(t){return arguments.length?(a.conf.zoomMode=t,a.status.graphStarted&&(a.conf.zoomMode?(a.main.zoom.scaleExtent([a.conf.minZoomFactor,a.conf.maxZoomFactor]).size([a.tools.getGraphWidth(),a.tools.getGraphHeight()]).on("zoom",a.main.zoomed),a.dom.graphOverlay.call(a.main.zoom),a.events.dblclickZoom=a.dom.graphOverlay.on("dblclick.zoom"),a.events.mousedownZoom=a.dom.graphOverlay.on("mousedown.zoom"),a.events.touchstartZoom=a.dom.graphOverlay.on("touchstart.zoom"),a.dom.graphOverlay.on("dblclick.zoom",a.tools.zoomEventProxy(a.events.dblclickZoom)),a.dom.graphOverlay.on("mousedown.zoom",a.tools.zoomEventProxy(a.events.mousedownZoom)),a.dom.graphOverlay.on("touchstart.zoom",a.tools.zoomEventProxy(a.events.touchstartZoom)),JSON.stringify(a.conf.transform)!==JSON.stringify(a.confDefaults.transform)&&(a.dom.graph.attr("transform","translate("+a.main.zoom.translate()+")scale("+a.main.zoom.scale()+")"),a.tools.writeConfObjectIntoWizard())):a.dom.graphOverlay.on(".zoom",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.zoomMode},r.minZoomFactor=function(t){return arguments.length?(a.conf.minZoomFactor=t,a.status.graphReady&&r.zoomMode(a.conf.zoomMode),r):a.conf.minZoomFactor},r.maxZoomFactor=function(t){return arguments.length?(a.conf.maxZoomFactor=t,a.status.graphReady&&r.zoomMode(a.conf.zoomMode),r):a.conf.maxZoomFactor},r.zoom=function(t,e,o,n){var s,i,l=a.tools.getGraphWidth(),d=a.tools.getGraphHeight();return t=isNaN(t)?l/2:parseInt(t),e=isNaN(e)?d/2:parseInt(e),o=isNaN(o)?l:parseInt(o),n=isNaN(n)?500:parseInt(n),s=[l/2-t*(i=l/o),d/2-e*i],a.main.interpolateZoom(s,i,n),r},r.zoomSmooth=function(t,e,o,n){return t=isNaN(t)?width/2:parseInt(t),e=isNaN(e)?height/2:parseInt(e),o=isNaN(o)?width:parseInt(o),n=isNaN(n)?1500:parseInt(n),r.zoom(t,e,o,n),r},r.transform=function(t,e){return arguments.length?(a.main.interpolateZoom(t.translate,t.scale,isNaN(e)?500:parseInt(e)),r):{translate:a.main.zoom.translate(),scale:a.main.zoom.scale()}},r.centerPositionGraph=function(){var t=a.dom.graph.node().getBBox();return[t.x+t.width/2,t.y+t.height/2]},r.centerPositionViewport=function(){var t,e,o={};return o.width=a.tools.getGraphWidth(),o.height=a.tools.getGraphHeight(),t=a.main.zoom.scale(),e=a.main.zoom.translate(),[1*(o.width/2-e[0])/t,1*(o.height/2-e[1])/t]},r.center=function(t){var e,o,n,s={};return t=isNaN(t)?500:parseInt(t),s.width=a.tools.getGraphWidth(),s.height=a.tools.getGraphHeight(),e=a.dom.graph.node().getBBox(),n=a.main.zoom.scale(),e.width>0&&e.height>0&&(o=[(s.width-e.width*n)/2-e.x*n,(s.height-e.height*n)/2-e.y*n],a.main.interpolateZoom(o,n,t)),r},r.zoomToFit=function(t){var e,o,n,s={};return t=isNaN(t)?500:parseInt(t),s.width=a.tools.getGraphWidth(),s.height=a.tools.getGraphHeight(),(e=a.dom.graph.node().getBBox()).width>0&&e.height>0&&(n=Math.min((s.height-20)/e.height,(s.width-20)/e.width),o=[(s.width-e.width*n)/2-e.x*n,(s.height-e.height*n)/2-e.y*n],a.main.interpolateZoom(o,n,t)),r},r.zoomToFitOnForceEnd=function(t){return arguments.length?(a.conf.zoomToFitOnForceEnd=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.zoomToFitOnForceEnd},r.zoomToFitOnResize=function(t){return arguments.length?(a.conf.zoomToFitOnResize=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.zoomToFitOnResize},r.keepAspectRatioOnResize=function(t){return arguments.length?(a.conf.keepAspectRatioOnResize=t,a.status.graphStarted&&(r.width(a.conf.width),r.height(a.conf.height),a.tools.removeLegend(),a.tools.createLegend(),a.tools.executeResize(),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.keepAspectRatioOnResize},r.onResizeFunction=function(t){return arguments.length?(a.conf.onResizeFunction=t,r):a.conf.onResizeFunction},r.onResizeFunctionTimeout=function(t){return arguments.length?(a.conf.onResizeFunctionTimeout=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.onResizeFunctionTimeout},r.showLoadingIndicatorOnAjaxCall=function(t){return arguments.length?(a.conf.showLoadingIndicatorOnAjaxCall=t,r):a.conf.showLoadingIndicatorOnAjaxCall},r.showLoadingIndicator=function(t){return a.tools.parseBool(t)?a.dom.loading.style("display","block"):a.dom.loading.style("display","none"),r},r.alignFixedNodesToGrid=function(t){var e,o;return arguments.length?(a.conf.alignFixedNodesToGrid=t,a.status.graphStarted&&(e=a.tools.getGraphWidth(),o=a.tools.getGraphHeight(),a.conf.alignFixedNodesToGrid?(a.status.graphReady&&a.main.nodes.each(function(t){t.fixed&&(t.x=t.px=a.tools.getNearestGridPosition(t.x,e),t.y=t.py=a.tools.getNearestGridPosition(t.y,o))}),a.main.drag.on("dragend",function(t){t.x=t.px=a.tools.getNearestGridPosition(t.x,e),t.y=t.py=a.tools.getNearestGridPosition(t.y,o)})):a.main.drag.on("dragend",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.alignFixedNodesToGrid},r.gridSize=function(t){return arguments.length?(a.conf.gridSize=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.gridSize},r.moveFixedNodes=function(t,e){return a.status.graphStarted&&(t||(t=0),e||(e=0),0===t&&0===e||a.main.nodes.each(function(o){o.fixed&&(o.x=o.px=a.conf.alignFixedNodesToGrid?a.tools.getNearestGridPosition(o.x+t,a.conf.width):o.x+t,o.y=o.py=a.conf.alignFixedNodesToGrid?a.tools.getNearestGridPosition(o.y+e,a.conf.width):o.y+e)})),r},r.releaseFixedNodes=function(){return a.status.graphStarted&&a.main.nodes.each(function(t){t.fixed=0}),r},r.nodeEventToStopPinMode=function(t){return arguments.length?(a.conf.nodeEventToStopPinMode=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.nodeEventToStopPinMode},r.onNodeContextmenuPreventDefault=function(t){return arguments.length?(a.conf.onNodeContextmenuPreventDefault=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.onNodeContextmenuPreventDefault},r.nodeEventToOpenLink=function(t){return arguments.length?(a.conf.nodeEventToOpenLink=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.nodeEventToOpenLink},r.nodeLinkTarget=function(t){return arguments.length?(a.conf.nodeLinkTarget=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.nodeLinkTarget},r.autoRefresh=function(t){return arguments.length?(a.conf.autoRefresh=t,a.status.graphStarted&&(a.conf.autoRefresh&&a.conf.refreshInterval&&!a.conf.interval?(a.conf.interval=window.setInterval(function(){r.start()},a.conf.refreshInterval),a.tools.log("Auto refresh started with an interval of "+a.conf.refreshInterval+" milliseconds.")):!a.conf.autoRefresh&&a.conf.interval&&(clearInterval(a.conf.interval),a.conf.interval=null,a.tools.log("Auto refresh stopped.")),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.autoRefresh},r.refreshInterval=function(t){return arguments.length?(a.conf.refreshInterval=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.refreshInterval},r.useDomParentWidth=function(t){return arguments.length?(a.conf.useDomParentWidth=t,a.status.graphStarted&&(a.conf.useDomParentWidth?a.tools.ResizeObserver.observe(a.dom.svgParent.node()):a.tools.ResizeObserver.unobserve(a.dom.svgParent.node()),a.conf.showLegend&&(a.tools.removeLegend(),a.tools.createLegend()),a.tools.executeResize()),r):a.conf.useDomParentWidth},r.setDomParentPaddingToZero=function(t){return arguments.length?(a.conf.setDomParentPaddingToZero=t,a.status.graphStarted&&(a.conf.setDomParentPaddingToZero?a.dom.svgParent.style("padding","0"):a.dom.svgParent.style("padding",null),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.setDomParentPaddingToZero},r.domParentWidth=function(){return a.tools.getSvgParentInnerWidth()},r.width=function(t){return arguments.length?(a.conf.width=t,a.status.graphStarted&&(a.conf.keepAspectRatioOnResize&&(a.conf.height=1*a.conf.width/a.status.aspectRatio),a.tools.executeResize(),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.width},r.height=function(t){return arguments.length?(a.conf.height=t,a.status.graphStarted&&(a.conf.keepAspectRatioOnResize&&(a.conf.width=a.conf.height*a.status.aspectRatio),a.tools.executeResize(),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.height},r.minNodeRadius=function(t){return arguments.length?(a.conf.minNodeRadius=t,a.status.graphReady&&(a.tools.setRadiusFunction(),a.main.nodes.each(function(t){t.radius=a.tools.radius(t.SIZEVALUE)}),a.main.nodes.attr("r",function(t){return t.radius}),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.minNodeRadius},r.maxNodeRadius=function(t){return arguments.length?(a.conf.maxNodeRadius=t,a.status.graphReady&&(a.tools.setRadiusFunction(),a.main.nodes.each(function(t){t.radius=a.tools.radius(t.SIZEVALUE)}),a.main.nodes.attr("r",function(t){return t.radius}),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.maxNodeRadius},r.selfLinkDistance=function(t){return arguments.length?(a.conf.selfLinkDistance=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.selfLinkDistance},r.linkDistance=function(t){return arguments.length?(a.conf.linkDistance=t,a.status.graphStarted&&(a.main.force.linkDistance(a.conf.linkDistance),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.linkDistance},r.charge=function(t){return arguments.length?(a.conf.charge=t,a.status.graphStarted&&(a.main.force.charge(a.conf.charge),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.charge},r.chargeDistance=function(t){return arguments.length?(a.conf.chargeDistance=t,a.status.graphStarted&&(a.main.force.chargeDistance(a.conf.chargeDistance),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.chargeDistance},r.gravity=function(t){return arguments.length?(a.conf.gravity=t,a.status.graphStarted&&(a.main.force.gravity(a.conf.gravity),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.gravity},r.linkStrength=function(t){return arguments.length?(a.conf.linkStrength=t,a.status.graphStarted&&(a.main.force.linkStrength(a.conf.linkStrength),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.linkStrength},r.friction=function(t){return arguments.length?(a.conf.friction=t,a.status.graphStarted&&(a.main.force.friction(a.conf.friction),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.friction},r.theta=function(t){return arguments.length?(a.conf.theta=t,a.status.graphStarted&&(a.main.force.theta(a.conf.theta),a.tools.createCustomizeWizardIfNotRendering()),r):a.conf.theta},r.forceTimeLimit=function(t){return arguments.length?(a.conf.forceTimeLimit=t,a.status.graphStarted&&a.tools.createCustomizeWizardIfNotRendering(),r):a.conf.forceTimeLimit},r.positions=function(t){if(arguments.length)return a.status.graphReady?t.constructor===Array?t.forEach(function(t){void 0!==a.data.idLookup[t.ID]&&(a.data.idLookup[t.ID].fixed=a.tools.parseBool(t.fixed),a.data.idLookup[t.ID].x=a.data.idLookup[t.ID].px=t.x,a.data.idLookup[t.ID].y=a.data.idLookup[t.ID].py=t.y)}):a.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):a.conf.positions=t,r;var e=[];return a.data.nodes.forEach(function(t){e.push({ID:t.ID,x:Math.round(t.x),y:Math.round(t.y),fixed:t.fixed?1:0})}),e},r.onLinkClickFunction=function(t){return arguments.length?(a.conf.onLinkClickFunction=t,r):a.conf.onLinkClickFunction},r.onNodeMouseenterFunction=function(t){return arguments.length?(a.conf.onNodeMouseenterFunction=t,r):a.conf.onNodeMouseenterFunction},r.onNodeMouseleaveFunction=function(t){return arguments.length?(a.conf.onNodeMouseleaveFunction=t,r):a.conf.onNodeMouseleaveFunction},r.onNodeClickFunction=function(t){return arguments.length?(a.conf.onNodeClickFunction=t,r):a.conf.onNodeClickFunction},r.onNodeDblclickFunction=function(t){return arguments.length?(a.conf.onNodeDblclickFunction=t,r):a.conf.onNodeDblclickFunction},r.onNodeContextmenuFunction=function(t){return arguments.length?(a.conf.onNodeContextmenuFunction=t,r):a.conf.onNodeContextmenuFunction},r.onLassoStartFunction=function(t){return arguments.length?(a.conf.onLassoStartFunction=t,r):a.conf.onLassoStartFunction},r.onLassoEndFunction=function(t){return arguments.length?(a.conf.onLassoEndFunction=t,r):a.conf.onLassoEndFunction},r.onRenderEndFunction=function(t){return arguments.length?(a.conf.onRenderEndFunction=t,r):a.conf.onRenderEndFunction},r.onForceStartFunction=function(t){return arguments.length?(a.conf.onForceStartFunction=t,r):a.conf.onForceStartFunction},r.onForceEndFunction=function(t){return arguments.length?(a.conf.onForceEndFunction=t,r):a.conf.onForceEndFunction},r.sampleData=function(t){return arguments.length?(a.data.sampleData=t,r):a.data.sampleData},r.nodes=function(){return a.main.nodes},r.links=function(){return a.main.links},r.selfLinks=function(){return a.main.selfLinks},r.data=function(){return a.data.dataConverted},r.nodeDataById=function(t){return a.data.idLookup[t]},r.options=function(t){var e;if(arguments.length)return a.tools.applyConfigurationObject(t),r;var o={};for(e in a.conf)a.conf.hasOwnProperty(e)&&(a.confDefaults.hasOwnProperty(e)?"bool"!==a.confDefaults[e].type&&"number"!==a.confDefaults[e].type&&"text"!==a.confDefaults[e].type||a.confDefaults[e].val===a.conf[e]?"object"===a.confDefaults[e].type&&JSON.stringify(a.confDefaults[e].val)!==JSON.stringify(a.conf[e])&&(o[e]=a.conf[e]):o[e]=a.conf[e]:a.confDefaults.hasOwnProperty(e)||void 0===a.conf[e]||null===a.conf[e]||(o[e]=a.conf[e]));return o},r.optionsCustomizationWizard=function(t){var e;if(arguments.length)return a.tools.applyConfigurationObject(t),r;var o={};for(e in a.confDefaults)a.confDefaults.hasOwnProperty(e)&&("bool"!==a.confDefaults[e].type&&"number"!==a.confDefaults[e].type&&"text"!==a.confDefaults[e].type||a.confDefaults[e].val===a.conf[e]?"object"===a.confDefaults[e].type&&JSON.stringify(a.confDefaults[e].val)!==JSON.stringify(a.conf[e])&&(o[e]=a.conf[e]):o[e]=a.conf[e]);return o},r.customize=function(t){return arguments.length?(a.status.customize=t,a.status.graphStarted&&(a.status.customize?(a.tools.createCustomizeWizard(),a.tools.removeCustomizeLink()):(a.tools.removeCustomizeWizard(),a.conf.debug&&a.tools.createCustomizeLink())),r):a.status.customize},r.debug=function(t){return arguments.length?(a.conf.debug=t,a.status.graphStarted&&(a.conf.debug?a.tools.createCustomizeLink():a.tools.removeCustomizeLink()),r):a.conf.debug},r.userAgent=function(){return a.status.userAgent},r.inspect=function(){return a},r.version=function(){return a.version},a.main.init(),a.status.apexPluginId&&apex.jQuery("#"+a.dom.containerId).bind("apexrefresh",function(){r.start()}),r}